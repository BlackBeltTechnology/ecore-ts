(function(){function i(e){var t=e.eContainer;return!t||t instanceof n.Model?"/":i(t)+"/"+e.get("name")}function u(e){var n=e.eClass;if(n){var r=n.eAllStructuralFeatures();if(!r||r.length===0)return;t.each(r,function(t){var n=t.get("name");if(n)if(t.isTypeOf("EAttribute"))e.has(n)||(e.values[n]=e._getDefaultAttributeValue(t));else{var r=e.values[n];r instanceof o?(r._setFeature(t),t.get("isContainment")&&r.each(function(t){t.eContainer=e})):e.has(n)||(e.values[n]=e._getDefaultReferenceValue(t))}})}}function d(e){var t=e.EClass=new f({name:"EClass"});t.eClass=t;var n=new l({name:"EString"});e.EString=n;var r=new l({name:"EInteger"});e.EInteger=r;var i=new l({name:"EBoolean"});e.EBoolean=i;var s=e.EModelElement=new f({name:"EModelElement","abstract":!0});s.eClass=t;var o=e.ENamedElement=new f({name:"ENamedElement","abstract":!0});o.eClass=t,o.get("eSuperTypes").add(s);var a=e.EAttribute=new f({name:"EAttribute"});a.eClass=t;var p=new h({name:"iD",eType:i});p.eClass=a,e.EAttribute_iD=p,a.get("eStructuralFeatures").add(p);var d=e.EReference=new f({name:"EReference"});d.eClass=t;var v=new h({name:"isContainment",eType:i});v.eClass=a,e.EReference_isContainment=v;var m=new h({name:"container",eType:i});m.eClass=a,e.EReference_container=m;var g=new h({name:"resolveProxies",eType:i});g.eClass=a,e.EReference_resolveProxies=g,d.get("eStructuralFeatures").add(v),d.get("eStructuralFeatures").add(m),d.get("eStructuralFeatures").add(g);var y=e.EPackage=new f({name:"EPackage"});y.eClass=t,y.get("eSuperTypes").add(o);var b=new h({name:"nsURI",eType:n});b.eClass=a,e.EPackage_nsURI=b;var w=new h({name:"nsPrefix",eType:n});w.eClass=a,e.EPackage_nsPrefix=w,y.get("eStructuralFeatures").add(b),y.get("eStructuralFeatures").add(w);var E=new h({name:"name",eType:n});E.eClass=a,e.ENamedElement_name=E,o.get("eStructuralFeatures").add(E);var S=new h({name:"abstract",lowerBound:0,upperBound:1,eType:i});S.eClass=a,e.EClass_abstract=S;var x=new h({name:"interface",eType:i});x.eClass=a,e.EClass_interface=x;var T=new c({name:"eStructuralFeatures",lowerBound:0,upperBound:-1,isContainment:!0});T.eClass=d;var N=new c({name:"eSuperTypes",lowerBound:0,upperBound:-1,isContainment:!1});N.eClass=d,t.get("eSuperTypes")._setFeature(N),t.get("eStructuralFeatures").add(S),t.get("eStructuralFeatures").add(x),t.get("eStructuralFeatures").add(T),t.get("eStructuralFeatures").add(N);var C=e.ETypedElement=new f({name:"ETypedElement","abstract":!0});C.eClass=t,C.get("eSuperTypes").add(o);var k=new h({name:"ordered",eType:i});k.eClass=a,e.ETypedElement_ordered=k;var L=new h({name:"unique",eType:i});L.eClass=a,e.ETypedElement_unique=L;var A=new h({name:"lowerBound",eType:r});A.eClass=a,e.ETypedElement_lowerBound=A;var O=new h({name:"upperBound",eType:r});O.eClass=a,e.ETypedElement_upperBound=O;var M=new h({name:"many",eType:i});M.eClass=a,e.ETypedElement_many=M;var _=new h({name:"required",eType:i});_.eClass=a,e.ETypedElement_required=_;var D=new c({name:"eType",eType:W});D.eClass=d,e.ETypedElement_eType=D,C.get("eStructuralFeatures").add(k),C.get("eStructuralFeatures").add(L),C.get("eStructuralFeatures").add(A),C.get("eStructuralFeatures").add(O),C.get("eStructuralFeatures").add(M),C.get("eStructuralFeatures").add(_);var P=e.EStructuralFeature=new f({name:"EStructuralFeature"});P.eClass=t,P.set("abstract",!0),P.set("interface",!1),P.get("eSuperTypes").add(C),a.get("eSuperTypes").add(P),d.get("eSuperTypes").add(P);var H=new h({name:"changeable",eType:i});H.eClass=a,e.EStructuralFeature_changeable=H;var B=new h({name:"volatile",eType:i});B.eClass=a,e.EStructuralFeature_volatile=B;var j=new h({name:"transient",eType:i});j.eClass=a,e.EStructuralFeature_transient=j;var F=new h({name:"defaultValueLiteral",eType:n});F.eClass=a,e.EStructuralFeature_defaultValueLiteral=F;var I=new h({name:"defaultValue",eType:n});I.eClass=a,e.EStructuralFeature_defaultValue=I;var q=new h({name:"unsettable",eType:i});q.eClass=a,e.EStructuralFeature_unsettable=q;var R=new h({name:"derived",eType:i});R.eClass=a,e.EStructuralFeature_derived=R,P.get("eStructuralFeatures").add(H),P.get("eStructuralFeatures").add(B),P.get("eStructuralFeatures").add(j),P.get("eStructuralFeatures").add(I),P.get("eStructuralFeatures").add(F),P.get("eStructuralFeatures").add(q),P.get("eStructuralFeatures").add(R);var U=e.EOperation=new f({name:"EOperation"});U.eClass=t,U.get("eSuperTypes").add(C);var z=e.EParameter=new f({name:"EParameter"});z.eClass=t,z.get("eSuperTypes").add(C);var W=e.EClassifier=new f({name:"EClassifier","abstract":!0});W.eClass=t;var X=e.EDataType=new f({name:"EDataType"});X.eClass=t,n.eClass=X,r.eClass=X,i.eClass=X,W.get("eSuperTypes").add(o),t.get("eSuperTypes").add(W),X.get("eSuperTypes").add(W);var V=new c({name:"eClassifiers",lowerBound:0,upperBound:-1,isContainment:!0,eType:W});V.eClass=d,e.EPackage_eClassifiers=V,y.get("eStructuralFeatures").add(V);var $=e.EFactory=new f({name:"EFactory"});$.eClass=t,$.get("eSuperTypes").add(s),e.EFactory=$;var J=new c({name:"eFactoryInstance",lowerBound:0,upperBound:1,eType:$});J.eClass=d,y.get("eStructuralFeatures").add(J),e.EPackage_eFactoryInstance=J;var K=new c({name:"ePackage",lowerBound:1,upperBound:1,eType:y,eOpposite:J});K.eClass=d,e.EFactory_ePackage=K,J.set("eOpposite",K),$.get("eStructuralFeatures").add(K),u(t),u(s),u(o),u(W),u(X),u(C),u(P),u(a),u(d),u(U),u(z),u(y),u($)}function y(){var e=new g("http://www.eclipse.org/emf/2002/Ecore");return e.add(n.EcorePackage),n.Registry.register(e),e}function w(e){var n=e.uri,r={},i=e.contents;if(i.length===1){var s=i[0];function o(e,n){var i=e.eClass,s=i.eAllStructuralFeatures();r[n]=e,t.each(s,function(t){var r=e.get(t.get("name"));if(r&&t.isTypeOf("EReference")&&t.get("isContainment"))if(t.get("upperBound")===1){var i=r.eURIFragmentSegment(t,n,-1);o(r,i)}else r.each(function(e){var i=r.indexOf(e),s=e.eURIFragmentSegment(t,n,i);o(e,s)})})}var u=s.eClass.get("eIDAttribute")||null;u?o(s,s.get(u.name)):o(s,"/")}return r}var e=this,t=e._||require("underscore"),n={create:function(e){if(!e.eClass)throw new Error("Cannot create EObject from undefined EClass");return new n.EObject({eClass:e})}};n.version="0.1.1",typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=n),exports.Ecore=n):e.Ecore=n;var r=n.EObject=function(e){return e||(e={}),this.eClass=e.eClass||null,this.values={},u(this),this},s={has:function(e){return this.values.hasOwnProperty(e)||this._isStructuralFeature(e)},set:function(e,t){return this.has(e)&&(this.values[e]=t),this},get:function(e){var t;return this.has(e)&&(t=this.values[e]),t},isTypeOf:function(e){return this.eClass.get("name")===e},isKindOf:function(e){var n=this.eClass;return n?t.any(n.eAllSuperTypes(),function(t){return t.get("name")===e}):!1},uri:function(){if(this.eContainer instanceof n.Model)return this.eContainer.uri+"#"+"/"},eURIFragmentSegment:function(e,t,n){if(this.isKindOf("EModelElement"))return i(this);var r=this.eClass,s=r.get("eIDAttribute"),o;return s?o=val.get(s.name):(o=t+"/@"+e.name,n>-1&&(o+="."+n)),o},_getDefaultAttributeValue:function(e){var t=e.get("eType"),n=e.get("upperBound");if(!n)return null;if(n!==1)return[];if(!t)return null;switch(t.get("name")){case"EString":return"";case"EBoolean":return!1;case"EInteger":return 0;default:return""}},_getDefaultReferenceValue:function(e){var t=e.get("upperBound");return t?t===1?null:new o(this,e):null},_initFeature:function(e){var t=e.get("name");e.isTypeOf("EAttribute")?this.values[t]=this._getDefaultAttributeValue(e):this.values[t]=this._getDefaultReferenceValue(e)},_isStructuralFeature:function(e){var n=this.eClass;if(!n)return!1;var r=n.eAllStructuralFeatures();if(!r)return!1;var i=t.find(r,function(t){return t.values?t.values.name===e:!1});return i?(t.has(this.values,e)||this._initFeature(i),!0):!1},eAllStructuralFeatures:function(){if(!this.has("eSuperTypes"))return[];var e=this.get("eSuperTypes"),n=t.flatten(t.map(e._internal,function(e){return e.eAllStructuralFeatures()})),r=t.union(n,this.get("eStructuralFeatures")._internal);return r},eAllSuperTypes:function(){var e=this.get("eSuperTypes")._internal,n=t.union(e,t.flatten(t.map(e,function(e){return e.eAllSuperTypes()})));return n}};t.extend(r.prototype,s);var o=n.EList=function(e,t){return this._internal=[],this._owner=e,this._size=0,this._index={},this._setFeature(t),this};o.prototype={_setFeature:function(e){e&&(this._feature=e,this._isContainment=this._feature.get("isContainment"))},add:function(e){return this._isContainment&&(e.eContainingFeature=this._feature,e.eContainer=this._owner),this._index[this._size]=e,this._size++,this._internal.push(e),this},remove:function(e){var n=t.values(this._index);return this},size:function(){return this._size},at:function(e){return this._size<e?null:this._internal[e]},first:function(){return t.first(this._internal)},last:function(){return t.last(this._internal)},rest:function(e){return t.rest(this._internal,e)},each:function(e,n){return t.each(this._internal,e,n)},filter:function(e,n){return t.filter(this._internal,e,n)},find:function(e,n){return t.find(this._internal,e,n)},reject:function(e,n){return t.reject(this._internal,e,n)},contains:function(e){return t.contains(this._internal,e)},indexOf:function(e){return t.indexOf(this._internal,e)}};var a=function(e){return e||(e={}),n.EcorePackage&&(this.eClass=n.EcorePackage.EPackage),this.values={},this.values.name=e.name,this.values.nsURI=e.nsURI,this.values.nsPrefix=e.nsPrefix,this.values.eClassifiers=new o(this),u(this),this};t.extend(a.prototype,s);var f=function(e){return e||(e={}),n.EcorePackage&&(this.eClass=n.EcorePackage.EClass),this.values={},this.values.name=e.name,this.values.abstract=e.abstract||!1,this.values.interface=e.interface||!1,this.values.eSuperTypes=new o(this),this.values.eStructuralFeatures=new o(this),u(this),this};t.extend(f.prototype,s);var l=function(e){return e||(e={}),n.EcorePackage&&(this.eClass=n.EcorePackage.EDataType),this.values={},this.values.name=e.name,u(this),this};t.extend(l.prototype,s);var c=function(e){return e||(e={}),n.EcorePackage&&(this.eClass=n.EcorePackage.EReference),this.values={name:e.name,lowerBound:e.lowerBound||0,upperBound:e.upperBound||1,isContainment:e.isContainment||!1,eType:e.eType||null,eOpposite:e.eOpposite||null},u(this),this};t.extend(c.prototype,s);var h=function(e){return e||(e={}),n.EcorePackage&&(this.eClass=n.EcorePackage.EAttribute),this.values={name:e.name,lowerBound:e.lowerBound||0,upperBound:e.upperBound||1,eType:e.eType||null},u(this),this};t.extend(h.prototype,s);var p=function(e){return e||(e={}),n.EcorePackage&&(this.eClass=n.EcorePackage.EFactory),this.values={ePackage:e.ePackage},u(this),this};t.extend(p.prototype,s),n.EcorePackage=new a({name:"ecore"}),d(n.EcorePackage),n.EcorePackage.get("eClassifiers")._setFeature(n.EcorePackage.EPackage_eClassifiers),n.EcorePackage.eClass=n.EcorePackage.EPackage,n.EcorePackage.set("nsURI","http://www.eclipse.org/emf/2002/Ecore"),n.EcorePackage.set("nsPrefix","ecore"),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EModelElement),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.ENamedElement),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EPackage),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EClassifier),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EClass),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EDataType),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.ETypedElement),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EStructuralFeature),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EAttribute),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EReference),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EOperation),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EParameter),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EFactory),n.EcoreFactory=new p,n.EcoreFactory.eClass=n.EcorePackage.EFactory,n.EcorePackage.set("eFactoryInstance",n.EcoreFactory),n.EcoreFactory.createEPackage=function(e){return new a(e)},n.EcoreFactory.createEClass=function(e){return new f(e)},n.EcoreFactory.createEAttribute=function(e){return new h(e)},n.EcoreFactory.createEReference=function(e){return new c(e)},n.EcoreFactory.create=function(e,t){switch(e){case"EPackage":return this.createEPackage(t);case"EClass":return this.createEClass(t);case"EAttribute":return this.createEAttribute(t);case"EReference":return this.createEReference(t);default:return null}};var v=n.EcoreFactory;n.$=e.jQuery||e.Zepto||e.ender||null;var m={get:function(e,t,r){return n.$?n.$.ajax({url:e,dataType:"json",success:t,error:r}):null},post:function(e,t,n){}};n.JSON={parse:function(e){function i(e,n){return!e||!n?function(e){}:function(r){var i=r.get("name"),o=e[i];r.isTypeOf("EAttribute")?n.set(i,o):r.get("upperBound")===1?n.set(i,s(o)):o&&t.each(o,function(e){n.get(i).add(s(e))})}}function s(e){if(e&&e.eClass){var r=n.Registry.getEObject(e.eClass),s=r.eAllStructuralFeatures(),o=n.create(r);return s&&t.each(s,i(e,o)),o}return null}var r=[];return r.push(s(e)),r},toJSON:function(e){function r(e,n){return!e||!n?function(e){}:function(r){var s=r.get("name"),o=e.get(s);r.isTypeOf("EAttribute")?n[s]=o:r.get("isContainment")&&(r.get("upperBound")===1?n[s]=i(o):(n[s]=[],o&&t.each(o,function(e){n[s].push(i(e))})))}}function i(e){var n=e.eClass,i=n.get("eStructuralFeatures"),s={};return i&&t.each(i,r(e,s)),s}var n=e.contents,s;if(n.length===1){var o=n[0];s=i(o)}return s}};var g=n.Model=function(e){return this.uri=e,this.contents=[],this};g.prototype={clear:function(){return this.contents.length=0,this},add:function(e){return e&&(e.eModel=this,e.eContainer=this,this.contents.push(e)),this},addAll:function(e){return t.isArray(e)&&t.each(e,function(e){this.add(e)},this),this},getEObject:function(e){return e?w(this)[e]:null},each:function(e,n){return t.each(this.contents,e,n)},save:function(e,t){var r=n.JSON.toJSON(this)},load:function(e,t,r){var i=this,s=function(t){var r=n.JSON.parse(t);return i.addAll(r),e(i)};return r?s(r):m.get(this.uri,s,t)}};var b=n.ModelRegistry=function(){var e;return b=function(){return e},b.prototype=this,e=new b,e.constructor=b,e.models={},e};b.prototype={register:function(e){return this.models[e.uri]=e,this},getEObject:function(e){var t=e.split("#"),n=t[0],r;t.length===2&&(r=t[1]);var i=this.models[n];if(i&&r){var s=w(i),o=s[r];return o}return null}},n.Registry=new n.ModelRegistry,y()})();