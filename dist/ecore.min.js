!function(){function a(a){var c=a.eClass;if(c){var d=c.get("eAllStructuralFeatures");j.each(d,function(c){b(a,c)})}}function b(a,b){if(a&&b){var c=b.get("name"),d=b.values.defaultValue,e=b.get("upperBound"),f=b.values.derived===!0,g=(b.values.containment===!0,a.values[c]),h=function(){var a;return a=null===d||void 0===d?null:0===d?0:d===!1?!1:d};(null===g||void 0===g)&&(f?a.values[c]=b.values._:1!==e&&e?g instanceof k.EList?g._setFeature(b):a.values[c]=b.isTypeOf("EAttribute")?[]:new k.EList(a,b):a.values[c]=h())}}function c(a,b){return j.find(a.get("eAllStructuralFeatures"),function(a){return a.values.name===b})}function d(a,b){if(a.eClass){var d=function(a,b){return"function"==typeof b?b:b instanceof m?b:k.create(a,b)},e=function(b,c,e,f){e?a.set(b,d(f,c)):a.set(b,c)},f=function(b,c,e,f){var g=j.isArray(c)?c:[c];j.each(g,function(c){e?a.get(b).add(d(f,c)):a.get(b).push(c)})};j.each(b,function(a,b){var d=c(this.eClass,b);d&&void 0!==a&&(1===d.get("upperBound")?e(b,a,d.eClass===k.EReference,d.get("eType")):f(b,a,d.eClass===V,d.get("eType")))},a)}}function e(a){var b=a.get("eOperations").array(),c=a.get("eAllSuperTypes"),d=j.flatten(j.union(b||[],j.map(c||[],function(a){return e(a)})));return d}function f(a){if(a&&a.eClass){var b=e(a.eClass);b&&j.each(b,function(b){a[b.get("name")]=b._})}}function g(a){var b={},c=a.get("contents").array();if(c.length){var d,e,f=function(a,c){var d=a.eContents();b[c]=a,j.each(d,function(a){f(a,a.fragment())})};if(1===c.length)d=c[0],e=d.eClass.get("eIDAttribute")||null,e?f(d,d.get(e.name)):f(d,"/");else for(var g=0;g<c.length;g++)d=c[g],e=d.eClass.get("eIDAttribute")||null,e?f(d,d.get(e.name)):f(d,"/"+g)}return b}function h(a){var b=/(>)(<)(\/*)/g,c=/ *(.*) +\n/g,d=/(<.+>)(.+\n)/g;a=a.replace(b,"$1\n$2$3").replace(c,"$1\n").replace(d,"$1\n$2");for(var e="",f=a.split("\n"),g=0,h="other",i={"single->single":0,"single->closing":-1,"single->opening":0,"single->other":0,"closing->single":0,"closing->closing":-1,"closing->opening":0,"closing->other":0,"opening->single":1,"opening->closing":0,"opening->opening":1,"opening->other":1,"other->single":0,"other->closing":-1,"other->opening":0,"other->other":0},j=0;j<f.length;j++){var k=f[j],l=Boolean(k.match(/<.+\/>/)),m=Boolean(k.match(/<\/.+>/)),n=Boolean(k.match(/<[^!].*>/)),o=l?"single":m?"closing":n?"opening":"other",p=h+"->"+o;h=o;var q="";g+=i[p];for(var r=0;g>r;r++)q+="    ";e+=q+k+"\n"}return e}var i=this,j=i._;j||"undefined"==typeof require||(j=require("underscore"));var k={version:"0.4.3",create:function(a,b){var c,d;if(b?(c=b,c.eClass=b.eClass||a):a instanceof m?(c={},c.eClass=a):c=a,!c.eClass||c.eClass.get("abstract"))throw new Error("Cannot create EObject from undefined or abstract EClass");return d=new m(c)}};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports.Ecore=k):i.Ecore=k;var l={on:function(a,b,c){var d,e,f;if(!b)return this;for(a=a.split(/\s+/),d=this._callbacks||(this._callbacks={});e=a.shift();)f=d[e]||(d[e]=[]),f.push(b,c);return this},off:function(a,b,c){var d,e,f,g;if(!(e=this._callbacks))return this;if(!(a||b||c))return delete this._callbacks,this;for(a=a?a.split(/\s+/):j.keys(e);d=a.shift();)if((f=e[d])&&(b||c))for(g=f.length-2;g>=0;g-=2)b&&f[g]!==b||c&&f[g+1]!==c||f.splice(g,2);else delete e[d];return this},trigger:function(a){var b,c,d,e,f,g,h,i;if(!(c=this._callbacks))return this;for(i=[],a=a.split(/\s+/),e=1,f=arguments.length;f>e;e++)i[e-1]=arguments[e];for(;b=a.shift();){if((h=c.all)&&(h=h.slice()),(d=c[b])&&(d=d.slice()),d)for(e=0,f=d.length;f>e;e+=2)d[e].apply(d[e+1]||this,i);if(h)for(g=[b].concat(i),e=0,f=h.length;f>e;e+=2)h[e].apply(h[e+1]||this,g)}return this}},m=function(b){return b||(b={}),this.eClass=b.eClass,this.values={},b._&&(this._=b._),a(this),d(this,b),f(this),this};k.EObjectPrototype={setEClass:function(b){return this.eClass=b,a(this),d(this,this.values),f(this),this},create:function(a){return"EClass"===this.eClass.get("name")?k.create(this,a):void 0},has:function(a){return this.values.hasOwnProperty(a)||c(this.eClass,a)},isSet:function(a){if(!this.has(a))return!1;var b=this.eClass;if(!b)return!1;var c=this.get(a);return c instanceof n?c.size()>0:null!==c&&"undefined"!=typeof c},set:function(a,b){var c,d,e,f;if(null===a)return this;j.isObject(a)||(d=a,(a={})[d]=b,b=arguments[2]);var g=this.eResource();for(c in a)e=a[c],"undefined"!=typeof e&&this.has(c)&&(this.values[c]=e,f="change:"+c,this.trigger("change "+f,c),g&&g.trigger("change",this));return this},get:function(a){if(!a)return null;var d=a.eClass?a.get("name"):a;!j.has(this.values,d)&&this.has(d)&&b(this,c(this.eClass,d));var e=this.values[d];return"function"==typeof e?e.apply(this):e},isTypeOf:function(a){if(!a||!this.eClass)return!1;var b=a.eClass?a.get("name"):a;return this.eClass.get("name")===b},isKindOf:function(a){if(!a||!this.eClass)return!1;if(this.isTypeOf(a))return!0;var b=a.eClass?a.get("name"):a,c=this.eClass.get("eAllSuperTypes");return j.any(c,function(a){return a.get("name")===b})},eResource:function(){return this.isKindOf("Resource")?this:this.eContainer?this.eContainer.isKindOf("Resource")?this.eContainer:this.eContainer.eResource():null},eContents:function(){if(!this.eClass)return[];var a=this.eClass.get("eAllStructuralFeatures"),b=j.filter(a,function(a){return a.isTypeOf("EReference")&&a.get("containment")&&this.isSet(a.get("name"))},this);return j.flatten(j.map(b,function(a){var b=this.get(a.get("name"));return b instanceof k.EList?b.array():b},this))},eURI:function(){var a=this.eResource();return a.get("uri")+"#"+this.fragment()},fragment:function(){var a,b,c,d=this.eContainer,e=this.eClass,f=e.get("eIDAttribute");return d?f?this.get(f.get("name")):this.isKindOf("EModelElement")?d?d.isKindOf("Resource")?(b=d.get("contents"),b.size()>1?"/"+b.indexOf(this):"/"):d.fragment()+"/"+this.get("name"):"/":(d.isKindOf("Resource")?(b=d.get("contents"),c=b.size()>1?"/"+b.indexOf(this):"/"):(a=this.eContainingFeature,a&&(c=d.fragment()+"/@"+a.get("name"),1!==a.get("upperBound")&&(c+="."+d.get(a.get("name")).indexOf(this)))),c):null}},j.extend(m.prototype,k.EObjectPrototype,l);var n=k.EList=function(a,b){return this._internal=[],this._owner=a,this._size=0,this._setFeature(b),this};n.prototype={_setFeature:function(a){a&&(this._feature=a,this._isContainment=this._feature.get("containment"),j.each(this._internal,function(a){this._isContainment&&(a.eContainer=this._owner,a.eContainingFeature=this._feature)},this))},add:function(a){if(!a||!a instanceof m)return this;this._isContainment&&(a.eContainingFeature=this._feature,a.eContainer=this._owner),this._size++,this._internal.push(a);var b=this._owner.eResource(),c="add";return this._feature&&(c+=":"+this._feature.get("name")),this._owner.trigger(c,a),b&&b.trigger("add",this),this},addAll:function(){return j.each(j.flatten(arguments||[]),function(a){this.add(a)},this),this},remove:function(a){var b="remove",c=this._owner.eResource();return this._internal=j.without(this._internal,a),this._size=this._size-1,this._feature&&(b+=":"+this._feature.get("name")),this._owner.trigger(b,a),c&&c.trigger("remove",this),this},clear:function(){for(var a=this.array(),b=0;b<a.length;b++)this.remove(a[b]);return this},size:function(){return this._size},at:function(a){if(this._size<a)throw new Error("Index Out Of Range");return this._internal[a]},array:function(){return this._internal},first:function(){return j.first(this._internal)},last:function(){return j.last(this._internal)},rest:function(a){return j.rest(this._internal,a)},each:function(a,b){return j.each(this._internal,a,b)},filter:function(a,b){return j.filter(this._internal,a,b)},find:function(a,b){return j.find(this._internal,a,b)},map:function(a,b){return j.map(this._internal,a,b)},reject:function(a,b){return j.reject(this._internal,a,b)},contains:function(a){return j.contains(this._internal,a)},indexOf:function(a){return j.indexOf(this._internal,a)}};var o=new m,p=new m,q=new m,r=new m,s=new m,t=new m,u=new m,v=new m,w=new m,x=new m,y=new m,z=new m;o.eClass=o,o.values={name:"EClass","abstract":!1,"interface":!1,eStructuralFeatures:new k.EList(o),eOperations:new k.EList(o),eSuperTypes:new k.EList(o),eAllSuperTypes:function(){if(!this._eAllSuperTypes){var a=function(a){var b=a.get("eSuperTypes").array(),c=j.flatten(j.map(b,function(a){return a.get("eAllSuperTypes")}));return j.union(c,b)};this.on("add:eSuperTypes remove:eSuperTypes",function(){this._eAllSuperTypes=a(this)},this),this._eAllSuperTypes=a(this)}return this._eAllSuperTypes},eAllSubTypes:function(){var a,b;return a=k.EPackage.Registry.elements("EClass"),b=j.filter(a,function(a){return j.contains(a.get("eAllSuperTypes"),this)},this),j.isArray(b)?b:[]},eReferences:function(){var a,b;return a=this.get("eStructuralFeatures"),b=a.filter(function(a){return a.isTypeOf("EReference")})},eAttributes:function(){var a,b;return a=this.get("eStructuralFeatures"),b=a.filter(function(a){return a.isTypeOf("EAttribute")})},eIDAttribute:function(){var a,b;return a=this.get("eAllAttributes"),b=j.filter(a,function(a){return a.get("iD")===!0}),j.isArray(b)?null:b},eAllStructuralFeatures:function(){var a=function(a){var b,c,d;return d=a.get("eAllSuperTypes"),c=a.values.eStructuralFeatures.array(),b=j.flatten(j.map(d||[],function(a){return a.values.eStructuralFeatures.array()})),j.union(b||[],c||[])};return a(this)},eAllAttributes:function(){var a=this.get("eAllStructuralFeatures"),b=j.filter(a||[],function(a){return a.eClass===k.EAttribute});return b},eAllContainments:function(){var a=this.get("eAllStructuralFeatures"),b=j.filter(a,function(a){return a.eClass===k.EReference&&a.get("containment")});return b},eAllReferences:function(){var a=this.get("eAllStructuralFeatures"),b=j.filter(a,function(a){return a.eClass===k.EReference&&!a.get("containment")});return b}},v.values={name:"abstract",lowerBound:0,upperBound:1,defaultValueLiteral:"false",defaultValue:!1,eType:r},w.values={name:"interface",lowerBound:0,upperBound:1,defaultValueLiteral:"false",defaultValue:!1,eType:r},x.values={name:"eStructuralFeatures",lowerBound:0,upperBound:-1,containment:!0},z.values={name:"eSuperTypes",lowerBound:0,upperBound:-1,containment:!1},y.values={name:"eOperations",lowerBound:0,upperBound:-1,containment:!0},o.get("eStructuralFeatures").add(v).add(w).add(z).add(x).add(y);var A=new m;A.values={name:"eAllStructuralFeatures",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:o.values.eAllStructuralFeatures};var B=new m;B.values={name:"eAllSuperTypes",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:o.values.eAllSuperTypes};var C=new m;C.values={name:"eAllSubTypes",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:o.values.eAllSubTypes};var D=new m;D.values={name:"eAllAttributes",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:o.values.eAllAttributes};var E=new m;E.values={name:"eAllContainments",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:o.values.eAllContainments};var F=new m;F.values={name:"eAllReferences",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:o.values.eAllReferences};var G=new m;G.values={name:"eReferences",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:o.values.eReferences};var H=new m;H.values={name:"eAttributes",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:o.values.eAttributes};var I=new m;I.values={name:"eIDAttribute",lowerBound:0,upperBound:1,derived:!0,containment:!1,_:o.values.eIDAttribute},o.get("eStructuralFeatures").add(A).add(B).add(C).add(D).add(F).add(E).add(H).add(G).add(I),o.getEStructuralFeature=function(a){var b;return b=a.eClass?a.get("name"):a,j.find(this.get("eAllStructuralFeatures"),function(a){return a.get("name")===b})};var J=new m;J.values={name:"getEStructuralFeature",lowerBound:0,upperBound:1,eParameters:new k.EList(this)},J._=o.getEStructuralFeature,o.get("eOperations").add(J),o.values.eStructuralFeatures._setFeature(x),o.values.eSuperTypes._setFeature(z),o.values.eOperations._setFeature(y);var K=o.create(),L=o.create(),M=o.create(),N=o.create(),O=o.create(),P=o.create(),Q=o.create(),R=o.create(),S=o.create(),T=o.create(),U=o.create(),V=o.create(),W=o.create(),X=o.create(),Y=o.create();v.eClass=U,w.eClass=U,x.eClass=V,x.values.eType=T,z.eClass=V,z.values.eType=o,y.eClass=V,y.values.eType=W,A.eClass=V,A.values.eType=T,B.eClass=V,B.values.eType=o,C.eClass=V,C.values.eType=o,D.eClass=V,D.values.eType=U,F.eClass=V,F.values.eType=V,E.eClass=V,E.values.eType=V,H.eClass=V,H.values.eType=U,G.eClass=V,G.values.eType=V,I.eClass=V,I.values.eType=U,J.eClass=W,J.values.eType=T,L.get("eSuperTypes").add(K),M.get("eSuperTypes").add(L),N.get("eSuperTypes").add(L),O.get("eSuperTypes").add(N),P.get("eSuperTypes").add(N),o.get("eSuperTypes").add(P),Q.get("eSuperTypes").add(P),R.get("eSuperTypes").add(Q),Y.get("eSuperTypes").add(N),S.get("eSuperTypes").add(N),T.get("eSuperTypes").add(S),U.get("eSuperTypes").add(T),V.get("eSuperTypes").add(T),W.get("eSuperTypes").add(S),X.get("eSuperTypes").add(S);var Z=new m,$=new m,_=new m,ab=new m,bb=new m,cb=new m,db=new m;Z.eClass=V,Z.values={name:"eType",lowerBound:0,upperBound:1,containment:!1,eType:P},$.eClass=U,$.values={name:"ordered",lowerBound:0,upperBound:1,defaultValueLiteral:"true",defaultValue:!0,eType:r},_.eClass=U,_.values={name:"unique",lowerBound:0,upperBound:1,defaultValueLiteral:"true",defaultValue:!0,eType:r},ab.eClass=U,ab.values={name:"lowerBound",lowerBound:0,upperBound:1,defaultValueLiteral:"0",defaultValue:0,eType:q},bb.eClass=U,bb.values={name:"upperBound",lowerBound:0,upperBound:1,defaultValueLiteral:"1",defaultValue:1,eType:q},cb.eClass=U,cb.values={name:"many",lowerBound:0,upperBound:1,eType:r,derived:!0,_:function(){return 1!==this.get("upperBound")}},db.eClass=U,db.values={name:"required",lowerBound:0,upperBound:1,eType:r,derived:!0,_:function(){return 1===this.get("lowerBound")}},S.get("eStructuralFeatures").add(Z).add($).add(_).add(ab).add(bb).add(cb).add(db);var eb=new m;eb.eClass=V,eb.values={name:"eAnnotations",eType:M,lowerBound:0,upperBound:-1,containment:!0},L.get("eStructuralFeatures").add(eb);var fb=new m;fb.eClass=U,fb.values={name:"name",lowerBound:0,upperBound:1,eType:p},N.get("eStructuralFeatures").add(fb);var gb=U.create({name:"changeable",eType:r}),hb=U.create({name:"volatile",eType:r}),ib=U.create({name:"transient",eType:r}),jb=U.create({name:"defaultValueLiteral",eType:p}),kb=U.create({name:"defaultValue",eType:u,derived:!0}),lb=U.create({name:"unsettable",eType:r}),mb=U.create({name:"derived",eType:r});T.get("eStructuralFeatures").add(gb).add(hb).add(ib).add(jb).add(kb).add(lb).add(mb),kb.set({derived:!0});var nb=U.create({name:"containment",eType:r}),ob=U.create({name:"container",eType:r}),pb=U.create({name:"resolveProxies",eType:r}),qb=V.create({name:"eOpposite",eType:V});V.get("eStructuralFeatures").add(nb).add(ob).add(pb).add(qb);var rb=U.create({name:"iD",eType:r});U.get("eStructuralFeatures").add(rb),K.set({name:"EObject"}),L.set({name:"EModelElement","abstract":!0}),M.set({name:"EAnnotation"}),N.set({name:"ENamedElement","abstract":!0}),O.set({name:"EPackage"}),P.set({name:"EClassifier","abstract":!0}),Q.set({name:"EDataType"}),R.set({name:"EEnum"}),S.set({name:"ETypedElement","abstract":!0}),T.set({name:"EStructuralFeature","abstract":!0}),U.set({name:"EAttribute"}),V.set({name:"EReference"}),W.set({name:"EOperation"}),X.set({name:"EParameter"}),Y.set({name:"EEnumLiteral"});var sb=V.create({name:"eParameters",eType:X,containment:!0,lowerBound:0,upperBound:-1});W.get("eStructuralFeatures").add(sb);var tb=V.create({name:"eLiterals",eType:Y,containment:!0,lowerBound:0,upperBound:-1});R.get("eStructuralFeatures").add(tb),Y.get("eStructuralFeatures").add(U.create({name:"literal",eType:p})).add(U.create({name:"value",eType:q}));var ub=o.create({name:"EStringToStringMapEntry"}),vb=U.create({name:"key",lowerBound:0,upperBound:1,eType:p}),wb=U.create({name:"value",lowerBound:0,upperBound:1,eType:p});ub.get("eStructuralFeatures").add(vb).add(wb);var xb=U.create({name:"source",upperBound:1,lowerBound:0,eType:p}),yb=V.create({name:"details",upperBound:-1,lowerBound:0,containment:!0,eType:ub});M.get("eStructuralFeatures").add(xb).add(yb),p.eClass=Q,p.set({name:"EString"}),q.eClass=Q,q.set({name:"EInt"}),r.eClass=Q,r.set({name:"EBoolean"}),t.eClass=Q,t.set({name:"EDate"}),s.eClass=Q,s.set({name:"EDouble"}),u.eClass=Q,u.set({name:"JSObject"}),k.ELong=Q.create({name:"ELong"}),k.EFloat=Q.create({name:"EFloat"}),k.EShort=Q.create({name:"EShort"});var zb=V.create({name:"eClassifiers",lowerBound:0,upperBound:-1,containment:!0,eType:P}),Ab=V.create({name:"eSubPackages",lowerBound:0,upperBound:-1,containment:!0,eType:O});O.get("eStructuralFeatures").add(U.create({name:"nsURI",eType:p})).add(U.create({name:"nsPrefix",eType:p})).add(zb).add(Ab),k.EcorePackage=O.create({name:"ecore",nsPrefix:"ecore",nsURI:"http://www.eclipse.org/emf/2002/Ecore"}),k.EcorePackage.get("eClassifiers").add(K).add(L).add(M).add(N).add(O).add(P).add(o).add(Q).add(S).add(T).add(U).add(V).add(W).add(X).add(R).add(Y).add(ub).add(p).add(r).add(q).add(s).add(t).add(k.EShort).add(k.EFloat).add(k.ELong).add(u),k.EObject=K,k.EModelElement=L,k.EClass=o,k.EClassifier=P,k.EAnnotation=M,k.EStringToStringMapEntry=ub,k.EPackage=O,k.ETypedElement=S,k.ENamedElement=N,k.EStructuralFeature=T,k.EAttribute=U,k.EReference=V,k.EEnum=R,k.EEnumLiteral=Y,k.EDataType=Q,k.EOperation=W,k.EParameter=X,k.EString=p,k.EBoolean=r,k.EInt=q,k.EDouble=s,k.EDate=t,k.JSObject=u,k.EPackage.Registry={_ePackages:{},getEPackage:function(a){return this._ePackages[a]},register:function(a){if(!a.isSet("nsURI"))throw new Error("Cannot register EPackage without nsURI");a.get("eSubPackages").each(function(a){register(a)}),this._ePackages[a.get("nsURI")]=a},ePackages:function(){return j.values(this._ePackages)},elements:function(a){var b=function(b){return a?a.eClass?b.eClass===a:b.eClass.get("name")===a:!0},c=this.ePackages(),d=function(a){return j.map(a.eContents(),function(a){return[a,d(a)]})},e=function(a){return d(a)},f=[c,j.map(c,e)];return f=j.flatten(f),f=j.filter(f,b)}},k.EPackage.Registry.register(k.EcorePackage),k.$=i.jQuery||i.Zepto||i.ender||null;var Bb={get:function(a,b,c,d){return k.$?k.$.ajax({url:a,dataType:b,success:c,error:d}):void 0},post:function(a,b,c,d,e){return k.$?k.$.ajax({type:"POST",url:a,dataType:c,data:b,success:d,error:e}):void 0}};k.JSON={dataType:"json",contentType:"application/json",parse:function(a,b){function c(a,b){return a&&b?function(c){if(!c.get("derived")){var d=c.get("name"),e=a[d];"undefined"!=typeof e&&(c.isTypeOf("EAttribute")?b.set(d,e):c.get("containment")?1===c.get("upperBound")?b.set(d,f(e)):j.each(e||[],function(a){b.get(d).add(f(a))}):h.push({parent:b,feature:c,value:e}))}}:function(){}}function d(a){return"/"===a.substring(0,1)}function e(){function b(a,b,e,f){var g,h=e.$ref;g=d(h)?c[h]:i.getEObject(h),g&&(f?a.get(b.get("name")).add(g):a.set(b.get("name"),g))}var c=g(a);j.each(h,function(a){var c=a.parent,d=a.feature,e=a.value;1===d.get("upperBound")?b(c,d,e,!1):j.each(e,function(a){b(c,d,a,!0)})})}function f(a){var b;if(a&&a.eClass){var d=i.getEObject(a.eClass),e=d.get("eAllStructuralFeatures");b=k.create(d),j.each(e,c(a,b))}return b}var h=[],i=a.get("resourceSet")||k.ResourceSet.create();j.isArray(b)?j.each(b,function(b){a.add(f(b))}):a.add(f(b)),e()},to:function(a){function b(a,b){var c=b.eResource(),d=a.eResource(),e=c!==d;if(c&&d){h[c.get("uri")]||(h[c.get("uri")]=g(c));var f=h[c.get("uri")];for(var i in f)if(f[i]===b)return e?c.get("uri")+"#"+i:i;return null}}function c(a,c,d){return d===!0?e(c):{$ref:b(a,c),eClass:c.eClass.eURI()}}function d(a,b){return a&&b?function(d,e){if("_"!==e[0]){var f=a.eClass.getEStructuralFeature(e),g=a.isSet(e);if(f&&g&&!f.get("derived")){var h=d,i=f.get("name"),j=1!==f.get("upperBound"),k=f.get("containment");f.isTypeOf("EAttribute")?b[i]=h:j?(b[i]=[],h.each(function(d){b[i].push(c(a,d,k))})):b[i]=c(a,h,k)}}}:function(){}}function e(a){var b=a.eClass,c=a.values,e={eClass:b.eURI()};return j.each(c,d(a,e)),e}var f=a.get("contents").array(),h={};h[a.get("uri")]=g(a);var i;if(1===f.length){var k=f[0];i=e(k)}else{i=[];for(var l=0;l<f.length;l++)i.push(e(f[l]))}return i}};var Cb=k.Resource=k.EClass.create({name:"Resource",eSuperTypes:[k.EObject],eStructuralFeatures:[{eClass:k.EAttribute,name:"uri",lowerBound:1,upperBound:1,eType:k.EString},{eClass:k.EReference,name:"contents",upperBound:-1,containment:!0,eType:k.EObject},{eClass:k.EReference,name:"resourceSet",upperBound:1,lowerBound:0,eType:k.ResourceSet}],eOperations:[{eClass:k.EOperation,name:"add",_:function(a){return a||a.eClass?(a.eContainer=this,this.get("contents").add(a),this):this}},{eClass:k.EOperation,name:"clear",_:function(){return this.get("contents").clear(),this}},{eClass:k.EOperation,name:"addAll",_:function(a){return j.isArray(a)&&j.each(a,function(a){this.add(a)},this),this}},{eClass:k.EOperation,name:"getEObject",eType:k.EObject,_:function(a){return a?g(this)[a]:null}},{eClass:k.EOperation,name:"each",_:function(a,b){return this.get("contents").each(a,b)}},{eClass:k.EOperation,name:"to",_:function(a,b){return a&&"function"==typeof a.to?a.to(this,b):k.JSON.to(this)}},{eClass:k.EOperation,name:"parse",_:function(a,b){return b&&"function"==typeof b.parse?b.parse(this,a):k.JSON.parse(this,a),this}},{eClass:k.EOperation,name:"save",_:function(a,b,c){c||(c={});var d=c.format?c.format:k.JSON,e=this.to(d),f=d.dataType,g=this.get("resourceSet"),h=g?g.uriConverter():null,i=this.get("uri");i=h?h.normalize(i):i,Bb.post(i,e,f,a,b)}},{eClass:k.EOperation,name:"load",_:function(a,b,c){c||(c={});var d=this,e=c.format||k.JSON,f=this.get("resourceSet"),g=f?f.uriConverter():null,h=this.get("uri"),i=function(b){return d.parse(b,e),d.trigger("change"),"function"==typeof a?a(d):void 0};return c.data?i(c.data):(f&&f.isSet("uri")&&(h=f.get("uri")+"/"+h),h=g?g.normalize(h):h,Bb.get(h,e.dataType,i,b))}},{eClass:k.EOperation,name:"remove",_:function(){var a=this.get("resourceSet");a&&a.get("resources").remove(this),this.clear()}},{eClass:k.EOperation,name:"_index",eType:u,_:function(){return g(this)}}]}),Db=function(){this.uriMap={}};Db.prototype={map:function(a,b){this.uriMap[a]=b},normalize:function(a){var b=a.split("#"),c=b[0],d=this.uriMap[c];if(d)return d;var e,f,g=c.lastIndexOf("/")+1;return e=c.slice(0,g),e===c?a:(f=c.slice(g,c.length),this.normalize(e)+f)}};var Eb=k.ResourceSet=k.EClass.create({name:"ResourceSet",eSuperTypes:[k.EObject],eStructuralFeatures:[{eClass:k.EAttribute,name:"uri",upperBound:1,lowerBound:0,eType:k.EString},{eClass:k.EReference,name:"resources",upperBound:-1,containment:!0,eType:Cb}],eOperations:[{eClass:k.EOperation,eType:k.Resource,upperBound:1,name:"create",_:function(a){var b,c,d=j.isObject(a)?a:{uri:a};if(!d.uri)throw new Error("Cannot create Resource, missing URI parameter");return(c=this.get("resources").find(function(a){return a.get("uri")===d.uri}))?c:(b=k.EPackage.Registry.getEPackage(d.uri))?(b.eResource()?(c=b.eResource(),c.set("resourceSet",this),this.get("resources").add(c)):(c=k.Resource.create(d),c.add(b),c.set("resourceSet",this),this.get("resources").add(c)),c):(c=k.Resource.create(d),c.set("resourceSet",this),this.get("resources").add(c),this.trigger("add",c),c)}},{eClass:k.EOperation,eType:k.EObject,upperBound:1,name:"getEObject",_:function(a){var b,c=a.split("#"),d=c[0],e=c[1];if(!e)return null;if(b=this.get("resources").find(function(a){return a.get("uri")===d}))return b.getEObject(e);var f=k.EPackage.Registry.getEPackage(d);if(f){if(!f.eResource()){var g=this.create({uri:d});g.add(f)}return f.eResource().set("resourceSet",this),this.get("resources").add(f.eResource()),this.getEObject(a)}return null}},{eClass:k.EOperation,eType:k.EObject,upperBound:-1,name:"elements",_:function(a){var b=function(b){return a?b.isKindOf(a):!0},c=this.get("resources").map(function(a){return j.filter(j.values(a._index()),b)});return j.flatten(c)}},{eClass:k.EOperation,eType:k.JSObject,upperBound:1,name:"uriConverter",_:function(){return this._converter||(this._converter=new Db),this._converter}},{eClass:k.EOperation,eType:k.JSObject,upperBound:1,name:"toJSON",_:function(){var a={total:this.get("resources").size(),resources:[]};return this.get("resources").each(function(b){a.resources.push({uri:b.get("uri"),length:b.get("contents").size(),contents:b.get("contents").map(function(a){return{eURI:a.eURI(),eClass:a.eClass.eURI()}})})}),a}},{eClass:k.EOperation,name:"parse",_:function(a){a&&a.resources&&j.each(a.resources,function(a){a.uri&&resourceSet.create({uri:a.uri})},this)}},{eClass:k.EOperation,name:"fetch",_:function(a,b){var c=this.get("uri");if(c){var d=this,e=function(b){return d.parse(b),d.trigger("change"),"function"==typeof a?a(d):void 0};Bb.get(c,k.JSON.dataType,e,b)}}}]});Cb.getEStructuralFeature("resourceSet").set("eType",Eb);var Fb=k.EPackage.create({name:"resources",nsPrefix:"resources",nsURI:"http://www.eclipselabs.org/ecore/2012/resources",eClassifiers:[Eb,Cb]}),Gb=k.Resource.create({uri:k.EcorePackage.get("nsURI")});Gb.add(k.EcorePackage);var Hb=k.Resource.create({uri:Fb.get("nsURI")});Hb.add(Fb),k.EPackage.Registry.register(Fb),k.sax="function"==typeof require?require("sax"):i.sax,k.XMI={dataType:"xml",contentType:"application/xml",parse:function(a,b){function c(a){a&&j.each(a,function(a,b){if(-1!==b.indexOf(":")){var c=b.split(":");"xmlns"===c[0]&&q.push({prefix:c[1],uri:a})}})}function d(a){var b=j.find(q,function(b){return b.prefix===a});return b?b.uri:null}function e(a){return f(a.name)}function f(a){return-1!==a.indexOf(":")}function g(a){var b=a.split(":"),c=b[0],e=b[1],f=d(c)+"#//"+e;return f}function h(a){var b;if(a.parent&&a.parent.eObject){var c,d=m.parent.eObject,e=a.name,f=d.eClass.getEStructuralFeature(e);if(f&&f.get)if(c=f.get("eType"),c.get("abstract")){var h=a.attributes["xsi:type"];h&&(b=p.getEObject(g(h)))}else b=c}return b}function i(a){return e(a)?p.getEObject(g(a.name)):h(a)}function l(){function b(a){return"/"===a.substring(0,1)}function c(a,c,e){var f,g=e.split(/\s/),h=1!==c.get("upperBound");j.each(g,function(e){"#"===e[0]&&(e=e.substring(1,e.length)),f=b(e)?d[e]:p.getEObject(e),f&&(h?a.get(c.get("name")).add(f):a.set(c.get("name"),f))})}var d=a._index();j.each(r,function(a){var b=a.parent,d=a.feature,e=a.value;c(b,d,e)})}if(!k.sax)throw new Error("Sax is missing.");var m,n,o=k.sax.parser(!0),p=a.get("resourceSet")||k.ResourceSet.create(),q=[],r=[];o.onopentag=function(a){var b,d,e,f;if(c(a.attributes),a.children=[],a.parent=m,a.parent&&a.parent.children.push(a),m=a,b=i(a),b&&(d=m.eObject=k.create(b),n||(n=d),j.each(a.attributes,function(a,b){d.has(b)&&(e=d.eClass.getEStructuralFeature(b),e.isTypeOf("EAttribute")?d.set(b,a):r.push({parent:d,feature:e,value:a}))}),a.parent&&(f=a.parent.eObject,f.has(a.name))))if(e=f.eClass.getEStructuralFeature(a.name),e.get("containment"))1===e.get("upperBound")?f.set(a.name,d):f.get(a.name).add(d);else{var g=a.attributes,h=g?g.href:null;h&&r.push({parent:f,feature:e,value:h})}},o.onclosetag=function(){var a;m&&m.parent&&(a=m.parent,delete m.parent,m=a)},o.write(b).close(),a.add(n),l()},to:function(a,b){function c(a){d+="<";var b;b=a.eContainingFeature&&a.eContainingFeature!==i?a.eContainingFeature.get("name"):f+":"+a.eClass.get("name"),d+=b,a.eContainer.isKindOf("Resource")&&(d+=' xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI"',d+=' xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"',d+=" xmlns:"+f+'="'+g+'"'),a.eContainingFeature.get("eType").get("abstract")&&(d+=' xsi:type="',d+=f+":"+a.eClass.get("name")+'"');var e=a.eClass.get("eAllStructuralFeatures"),h=j.filter(e,function(b){return!b.get("derived")&&b.isTypeOf("EAttribute")&&a.isSet(b.get("name"))}),l=j.filter(e,function(b){return!b.get("derived")&&b.isTypeOf("EReference")&&!b.get("containment")&&a.isSet(b.get("name"))});j.each(h,function(b){var c=b.get("name"),e=a.get(c);void 0!==e&&"false"!==e&&(d+=" "+c+'="'+e+'"')});var m=[];if(j.each(l,function(b){var c=a.get(b.get("name")),e=c instanceof k.EList?c.array():c?[c]:[],f=j.filter(e,function(b){return b.eResource()!==a.eResource()});f.length&&m.push({feature:b,refs:f});var g=j.difference(e,f),h=j.map(g,function(a){return a.fragment()});h.length&&(d+=" "+b.get("name")+'="'+h.join(" ")+'"')}),0===a.eContents().length&&0===m.length)d+="/>";else{d+=">",j.each(m,function(a){var b,c=a.feature,e=a.refs,f=c.get("eType").get("abstract");j.each(e,function(a){d+="<"+c.get("name"),f&&(b=a.eClass.eContainer.get("nsPrefix"),d+=' xsi:type="'+(b?b+":":"")+a.eClass.get("name")+'"'),d+=' href="'+a.eURI()+'" />'})});var n=j.filter(e,function(b){return b.isTypeOf("EReference")&&b.get("containment")&&a.isSet(b.get("name"))});j.each(n,function(b){var d=a.get(b.get("name"));1!==b.get("upperBound")?d.each(function(a){c(a)}):c(d)}),d+="</"+b+">"}return d}var d="",e=a.get("contents").first(),f=e.eClass.eContainer.get("nsPrefix"),g=e.eClass.eContainer.get("nsURI"),i=k.Resource.getEStructuralFeature("contents");return c(e),d=b?h(d):d,d='<?xml version="1.0" encoding="UTF-8"?>\n'+d}}}();