(function(){function n(t){var r=t.eContainer;return!r||r instanceof e.Model?"/":n(r)+"/"+t.get("name")}function s(e){var t=e.eClass;if(t){var n=t.eAllStructuralFeatures();if(!n||n.length===0)return;_.each(n,function(t){var n=t.get("name");if(n)if(t.isTypeOf("EAttribute"))e.has(n)||(e.values[n]=e._getDefaultAttributeValue(t));else{var r=e.values[n];r instanceof i?(r._setFeature(t),t.get("isContainment")&&r.each(function(t){t.eContainer=e})):e.has(n)||(e.values[n]=e._getDefaultReferenceValue(t))}})}}function p(e){var t=e.EClass=new a({name:"EClass"});t.eClass=t;var n=new f({name:"EString"});e.EString=n;var r=new f({name:"EInteger"});e.EInteger=r;var i=new f({name:"EBoolean"});e.EBoolean=i;var o=e.EModelElement=new a({name:"EModelElement","abstract":!0});o.eClass=t;var u=e.ENamedElement=new a({name:"ENamedElement","abstract":!0});u.eClass=t,u.get("eSuperTypes").add(o);var h=e.EAttribute=new a({name:"EAttribute"});h.eClass=t;var p=new c({name:"iD",eType:i});p.eClass=h,e.EAttribute_iD=p,h.get("eStructuralFeatures").add(p);var d=e.EReference=new a({name:"EReference"});d.eClass=t;var v=new c({name:"isContainment",eType:i});v.eClass=h,e.EReference_isContainment=v;var m=new c({name:"container",eType:i});m.eClass=h,e.EReference_container=m;var g=new c({name:"resolveProxies",eType:i});g.eClass=h,e.EReference_resolveProxies=g,d.get("eStructuralFeatures").add(v),d.get("eStructuralFeatures").add(m),d.get("eStructuralFeatures").add(g);var y=e.EPackage=new a({name:"EPackage"});y.eClass=t,y.get("eSuperTypes").add(u);var b=new c({name:"nsURI",eType:n});b.eClass=h,e.EPackage_nsURI=b;var w=new c({name:"nsPrefix",eType:n});w.eClass=h,e.EPackage_nsPrefix=w,y.get("eStructuralFeatures").add(b),y.get("eStructuralFeatures").add(w);var E=new c({name:"name",eType:n});E.eClass=h,e.ENamedElement_name=E,u.get("eStructuralFeatures").add(E);var S=new c({name:"abstract",lowerBound:0,upperBound:1,eType:i});S.eClass=h,e.EClass_abstract=S;var x=new c({name:"interface",eType:i});x.eClass=h,e.EClass_interface=x;var T=new l({name:"eStructuralFeatures",lowerBound:0,upperBound:-1,isContainment:!0});T.eClass=d;var N=new l({name:"eSuperTypes",lowerBound:0,upperBound:-1,isContainment:!1});N.eClass=d,t.get("eSuperTypes")._setFeature(N),t.get("eStructuralFeatures").add(S),t.get("eStructuralFeatures").add(x),t.get("eStructuralFeatures").add(T),t.get("eStructuralFeatures").add(N);var C=e.ETypedElement=new a({name:"ETypedElement","abstract":!0});C.eClass=t,C.get("eSuperTypes").add(u);var k=new c({name:"ordered",eType:i});k.eClass=h,e.ETypedElement_ordered=k;var L=new c({name:"unique",eType:i});L.eClass=h,e.ETypedElement_unique=L;var A=new c({name:"lowerBound",eType:r});A.eClass=h,e.ETypedElement_lowerBound=A;var O=new c({name:"upperBound",eType:r});O.eClass=h,e.ETypedElement_upperBound=O;var M=new c({name:"many",eType:i});M.eClass=h,e.ETypedElement_many=M;var _=new c({name:"required",eType:i});_.eClass=h,e.ETypedElement_required=_;var D=new l({name:"eType",eType:W});D.eClass=d,e.ETypedElement_eType=D,C.get("eStructuralFeatures").add(k),C.get("eStructuralFeatures").add(L),C.get("eStructuralFeatures").add(A),C.get("eStructuralFeatures").add(O),C.get("eStructuralFeatures").add(M),C.get("eStructuralFeatures").add(_);var P=e.EStructuralFeature=new a({name:"EStructuralFeature"});P.eClass=t,P.set("abstract",!0),P.set("interface",!1),P.get("eSuperTypes").add(C),h.get("eSuperTypes").add(P),d.get("eSuperTypes").add(P);var H=new c({name:"changeable",eType:i});H.eClass=h,e.EStructuralFeature_changeable=H;var B=new c({name:"volatile",eType:i});B.eClass=h,e.EStructuralFeature_volatile=B;var j=new c({name:"transient",eType:i});j.eClass=h,e.EStructuralFeature_transient=j;var F=new c({name:"defaultValueLiteral",eType:n});F.eClass=h,e.EStructuralFeature_defaultValueLiteral=F;var I=new c({name:"defaultValue",eType:n});I.eClass=h,e.EStructuralFeature_defaultValue=I;var q=new c({name:"unsettable",eType:i});q.eClass=h,e.EStructuralFeature_unsettable=q;var R=new c({name:"derived",eType:i});R.eClass=h,e.EStructuralFeature_derived=R,P.get("eStructuralFeatures").add(H),P.get("eStructuralFeatures").add(B),P.get("eStructuralFeatures").add(j),P.get("eStructuralFeatures").add(I),P.get("eStructuralFeatures").add(F),P.get("eStructuralFeatures").add(q),P.get("eStructuralFeatures").add(R);var U=e.EOperation=new a({name:"EOperation"});U.eClass=t,U.get("eSuperTypes").add(C);var z=e.EParameter=new a({name:"EParameter"});z.eClass=t,z.get("eSuperTypes").add(C);var W=e.EClassifier=new a({name:"EClassifier","abstract":!0});W.eClass=t;var X=e.EDataType=new a({name:"EDataType"});X.eClass=t,n.eClass=X,r.eClass=X,i.eClass=X,W.get("eSuperTypes").add(u),t.get("eSuperTypes").add(W),X.get("eSuperTypes").add(W);var V=new l({name:"eClassifiers",lowerBound:0,upperBound:-1,isContainment:!0,eType:W});V.eClass=d,e.EPackage_eClassifiers=V,y.get("eStructuralFeatures").add(V);var $=e.EFactory=new a({name:"EFactory"});$.eClass=t,$.get("eSuperTypes").add(o),e.EFactory=$;var J=new l({name:"eFactoryInstance",lowerBound:0,upperBound:1,eType:$});J.eClass=d,y.get("eStructuralFeatures").add(J),e.EPackage_eFactoryInstance=J;var K=new l({name:"ePackage",lowerBound:1,upperBound:1,eType:y,eOpposite:J});K.eClass=d,e.EFactory_ePackage=K,J.set("eOpposite",K),$.get("eStructuralFeatures").add(K),s(t),s(o),s(u),s(W),s(X),s(C),s(P),s(h),s(d),s(U),s(z),s(y),s($)}function m(){var t=new v("http://www.eclipse.org/emf/2002/Ecore");return t.add(e.EcorePackage),e.Registry.register(t),t}function y(e){var t=e.uri,n={},r=e.contents;if(r.length===1){var i=r[0];function s(e,t){var r=e.eClass,i=r.eAllStructuralFeatures();n[t]=e,_.each(i,function(n){var r=e.get(n.get("name"));if(r&&n.isTypeOf("EReference")&&n.get("isContainment"))if(n.get("upperBound")===1){var i=r.eURIFragmentSegment(n,t,-1);s(r,i)}else r.each(function(e){var i=r.indexOf(e),o=e.eURIFragmentSegment(n,t,i);s(e,o)})})}var o=i.eClass.get("eIDAttribute")||null;o?s(i,"//"+i.get(o.name)):s(i,"/")}return n}var e={create:function(t){if(!t.eClass)throw new Error("Cannot create EObject from undefined EClass");return new e.EObject({eClass:t})}};e.VERSION="0.1.0";var t=this;typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=e),exports.Ecore=e):t.Ecore=e;var r={has:function(e){return this.values.hasOwnProperty(e)||this._isStructuralFeature(e)},set:function(e,t){return this.has(e)&&(this.values[e]=t),this},get:function(e){var t;return this.has(e)&&(t=this.values[e]),t},isTypeOf:function(e){return this.eClass.get("name")===e},isKindOf:function(e){var t=this.eClass;return t?_.any(t.eAllSuperTypes(),function(t){return t.get("name")===e}):!1},uri:function(){if(this.eContainer instanceof e.Model)return this.eContainer.uri+"#"+"/"},eURIFragmentSegment:function(e,t,r){if(this.isKindOf("EModelElement"))return n(this);var i=this.eClass,s=i.get("eIDAttribute"),o;return s?o=val.get(s.name):(o=t+"/@"+e.name,r>-1&&(o+="."+r)),o},_getDefaultAttributeValue:function(e){var t=e.get("eType"),n=e.get("upperBound");if(!n)return null;if(n!==1)return[];if(!t)return null;switch(t.get("name")){case"EString":return"";case"EBoolean":return!1;case"EInteger":return 0;default:return""}},_getDefaultReferenceValue:function(e){var t=e.get("upperBound");return t?t===1?null:new i(this,e):null},_initFeature:function(e){var t=e.get("name");e.isTypeOf("EAttribute")?this.values[t]=this._getDefaultAttributeValue(e):this.values[t]=this._getDefaultReferenceValue(e)},_isStructuralFeature:function(e){var t=this.eClass;if(!t)return!1;var n=t.eAllStructuralFeatures();if(!n)return!1;var r=_.find(n,function(t){return t.values?t.values.name===e:!1});return r?(_.has(this.values,e)||this._initFeature(r),!0):!1},eAllStructuralFeatures:function(){if(!this.has("eSuperTypes"))return[];var e=this.get("eSuperTypes"),t=_.flatten(_.map(e._internal,function(e){return e.eAllStructuralFeatures()})),n=_.union(t,this.get("eStructuralFeatures")._internal);return n},eAllSuperTypes:function(){var e=this.get("eSuperTypes")._internal,t=_.union(e,_.flatten(_.map(e,function(e){return e.eAllSuperTypes()})));return t}},i=e.EList=function(e,t){return this._internal=[],this._owner=e,this._size=0,this._index={},this._setFeature(t),this};i.prototype={_setFeature:function(e){e&&(this._feature=e,this._isContainment=this._feature.get("isContainment"))},add:function(e){return this._isContainment&&(e.eContainingFeature=this._feature,e.eContainer=this._owner),this._index[this._size]=e,this._size++,this._internal.push(e),this},remove:function(e){var t=_.values(this._index);return this},size:function(){return this._size},at:function(e){return this._size<e?null:this._internal[e]},first:function(){return _.first(this._internal)},last:function(){return _.last(this._internal)},rest:function(e){return _.rest(this._internal,e)},each:function(e,t){return _.each(this._internal,e,t)},filter:function(e,t){return _.filter(this._internal,e,t)},find:function(e,t){return _.find(this._internal,e,t)},reject:function(e,t){return _.reject(this._internal,e,t)},contains:function(e){return _.contains(this._internal,e)},indexOf:function(e){return _.indexOf(this._internal,e)}};var o=e.EObject=function(e){return e||(e={}),this.eClass=e.eClass||null,this.values={},s(this),this};_.extend(o.prototype,r);var u=function(t){return t||(t={}),e.EcorePackage&&(this.eClass=e.EcorePackage.EPackage),this.values={},this.values.name=t.name,this.values.nsURI=t.nsURI,this.values.nsPrefix=t.nsPrefix,this.values.eClassifiers=new i(this),s(this),this};_.extend(u.prototype,r);var a=function(t){return t||(t={}),e.EcorePackage&&(this.eClass=e.EcorePackage.EClass),this.values={},this.values.name=t.name,this.values.abstract=t.abstract||!1,this.values.interface=t.interface||!1,this.values.eSuperTypes=new i(this),this.values.eStructuralFeatures=new i(this),s(this),this};_.extend(a.prototype,r);var f=function(t){return t||(t={}),e.EcorePackage&&(this.eClass=e.EcorePackage.EDataType),this.values={},this.values.name=t.name,s(this),this};_.extend(f.prototype,r);var l=function(t){return t||(t={}),e.EcorePackage&&(this.eClass=e.EcorePackage.EReference),this.values={name:t.name,lowerBound:t.lowerBound||0,upperBound:t.upperBound||1,isContainment:t.isContainment||!1,eType:t.eType||null,eOpposite:t.eOpposite||null},s(this),this};_.extend(l.prototype,r);var c=function(t){return t||(t={}),e.EcorePackage&&(this.eClass=e.EcorePackage.EAttribute),this.values={name:t.name,lowerBound:t.lowerBound||0,upperBound:t.upperBound||1,eType:t.eType||null},s(this),this};_.extend(c.prototype,r);var h=function(t){return t||(t={}),e.EcorePackage&&(this.eClass=e.EcorePackage.EFactory),this.values={ePackage:t.ePackage},s(this),this};_.extend(h.prototype,r),e.EcorePackage=new u({name:"ecore"}),p(e.EcorePackage),e.EcorePackage.get("eClassifiers")._setFeature(e.EcorePackage.EPackage_eClassifiers),e.EcorePackage.eClass=e.EcorePackage.EPackage,e.EcorePackage.set("nsURI","http://www.eclipse.org/emf/2002/Ecore"),e.EcorePackage.set("nsPrefix","ecore"),e.EcorePackage.get("eClassifiers").add(e.EcorePackage.EModelElement),e.EcorePackage.get("eClassifiers").add(e.EcorePackage.ENamedElement),e.EcorePackage.get("eClassifiers").add(e.EcorePackage.EPackage),e.EcorePackage.get("eClassifiers").add(e.EcorePackage.EClassifier),e.EcorePackage.get("eClassifiers").add(e.EcorePackage.EClass),e.EcorePackage.get("eClassifiers").add(e.EcorePackage.EDataType),e.EcorePackage.get("eClassifiers").add(e.EcorePackage.ETypedElement),e.EcorePackage.get("eClassifiers").add(e.EcorePackage.EStructuralFeature),e.EcorePackage.get("eClassifiers").add(e.EcorePackage.EAttribute),e.EcorePackage.get("eClassifiers").add(e.EcorePackage.EReference),e.EcorePackage.get("eClassifiers").add(e.EcorePackage.EOperation),e.EcorePackage.get("eClassifiers").add(e.EcorePackage.EParameter),e.EcorePackage.get("eClassifiers").add(e.EcorePackage.EFactory),e.EcoreFactory=new h,e.EcoreFactory.eClass=e.EcorePackage.EFactory,e.EcorePackage.set("eFactoryInstance",e.EcoreFactory),e.EcoreFactory.createEPackage=function(e){return new u(e)},e.EcoreFactory.createEClass=function(e){return new a(e)},e.EcoreFactory.createEAttribute=function(e){return new c(e)},e.EcoreFactory.createEReference=function(e){return new l(e)},e.EcoreFactory.create=function(e,t){switch(e){case"EPackage":return this.createEPackage(t);case"EClass":return this.createEClass(t);case"EAttribute":return this.createEAttribute(t);case"EReference":return this.createEReference(t);default:return null}},EcoreFactory=e.EcoreFactory,e.$=t.jQuery||t.Zepto||t.ender||null;var d={get:function(t,n,r){return e.$?e.$.ajax({url:t,dataType:"json",success:n,error:r}):null},post:function(e,t,n){}};e.JSON={parse:function(t){function r(e,t){return!e||!t?function(e){}:function(n){var r=n.get("name"),s=e[r];n.isTypeOf("EAttribute")?t.set(r,s):n.get("upperBound")===1?t.set(r,i(s)):_.each(s,function(e){t.get(r).add(i(e))})}}function i(t){if(t&&t.eClass){var n=e.Registry.getEObject(t.eClass),i=n.eAllStructuralFeatures(),s=e.create(n);return _.each(i,r(t,s)),s}return null}var n=[];return n.push(i(t)),n},toJSON:function(e){function n(e,t){return!e||!t?function(e){}:function(n){var i=n.get("name"),s=e.get(i);n.isTypeOf("EAttribute")?t[i]=s:n.get("isContainment")&&(n.get("upperBound")===1?t[i]=r(s):(t[i]=[],_.each(s,function(e){t[i].push(r(e))})))}}function r(e){var t=e.eClass,r=t.get("eStructuralFeatures"),i={};return _.each(r,n(e,i)),i}var t=e.contents,i;if(t.length===1){var s=t[0];i=r(s)}return i}};var v=e.Model=function(e){return this.uri=e,this.contents=[],this};v.prototype={clear:function(){return this.contents.length=0,this},add:function(e){return e&&(e.eModel=this,e.eContainer=this,this.contents.push(e)),this},addAll:function(e){return _.isArray(e)&&_.each(e,function(e){this.add(e)},this),this},getEObject:function(e){return e?y(this)[e]:null},each:function(e,t){return _.each(this.contents,e,t)},save:function(t,n){var r=e.JSON.toJSON(this)},load:function(t,n,r){var i=this,s=function(n){var r=e.JSON.parse(n);return i.addAll(r),t(i)};return r?s(r):d.get(this.uri,s,n)}};var g=e.ModelRegistry=function(){var e;return g=function(){return e},g.prototype=this,e=new g,e.constructor=g,e.models={},e};g.prototype={register:function(e){return this.models[e.uri]=e,this},getEObject:function(e){var t=e.split("#"),n=t[0],r;t.length===2&&(r=t[1]);var i=this.models[n];if(i&&r){var s=y(i),o=s[r];return o}return null}},e.Registry=new e.ModelRegistry,m()})();