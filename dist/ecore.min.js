(function(){function i(e){var t=e.eContainer;return!t||t instanceof n.Resource?"/":i(t)+"/"+e.get("name")}function u(e){var n=e.eClass;if(n){var r=n.eAllStructuralFeatures();t.each(r,function(t){var n=t.get("name");if(n)if(t.isTypeOf("EAttribute"))e.has(n)||(e.values[n]=e._getDefaultAttributeValue(t));else{var r=e.values[n];r instanceof o?(r._setFeature(t),t.get("isContainment")&&r.each(function(t){t.eContainer=e})):e.has(n)||(e.values[n]=e._getDefaultReferenceValue(t))}})}}function a(e,n){if(!e.eClass)return;t.each(n,function(e,t){var n=this.eClass.getEStructuralFeature(t);n&&(n.get("upperBound")===1?this.set(t,e):this.get(t).addAll(e))},e)}function v(e){var t=e.EClass=new l({name:"EClass"});t.eClass=t;var n=new c({name:"EString"});e.EString=n;var r=new c({name:"EInteger"});e.EInteger=r;var i=new c({name:"EBoolean"});e.EBoolean=i;var s=e.EModelElement=new l({name:"EModelElement","abstract":!0});s.eClass=t;var o=e.ENamedElement=new l({name:"ENamedElement","abstract":!0});o.eClass=t,o.get("eSuperTypes").add(s);var a=e.EAttribute=new l({name:"EAttribute"});a.eClass=t;var f=new p({name:"iD",eType:i});f.eClass=a,e.EAttribute_iD=f,a.get("eStructuralFeatures").add(f);var d=e.EReference=new l({name:"EReference"});d.eClass=t;var v=new p({name:"isContainment",eType:i});v.eClass=a,e.EReference_isContainment=v;var m=new p({name:"container",eType:i});m.eClass=a,e.EReference_container=m;var g=new p({name:"resolveProxies",eType:i});g.eClass=a,e.EReference_resolveProxies=g,d.get("eStructuralFeatures").add(v),d.get("eStructuralFeatures").add(m),d.get("eStructuralFeatures").add(g);var y=e.EPackage=new l({name:"EPackage"});y.eClass=t,y.get("eSuperTypes").add(o);var b=new p({name:"nsURI",eType:n});b.eClass=a,e.EPackage_nsURI=b;var w=new p({name:"nsPrefix",eType:n});w.eClass=a,e.EPackage_nsPrefix=w,y.get("eStructuralFeatures").add(b),y.get("eStructuralFeatures").add(w);var E=new p({name:"name",eType:n});E.eClass=a,e.ENamedElement_name=E,o.get("eStructuralFeatures").add(E);var S=new p({name:"abstract",lowerBound:0,upperBound:1,eType:i});S.eClass=a,e.EClass_abstract=S;var x=new p({name:"interface",eType:i});x.eClass=a,e.EClass_interface=x;var T=new h({name:"eStructuralFeatures",lowerBound:0,upperBound:-1,isContainment:!0});T.eClass=d;var N=new h({name:"eSuperTypes",lowerBound:0,upperBound:-1,isContainment:!1});N.eClass=d,t.get("eSuperTypes")._setFeature(N),t.get("eStructuralFeatures").add(S),t.get("eStructuralFeatures").add(x),t.get("eStructuralFeatures").add(T),t.get("eStructuralFeatures").add(N);var C=e.EClassifier=new l({name:"EClassifier","abstract":!0});C.eClass=t;var k=e.EDataType=new l({name:"EDataType"});k.eClass=t;var L=e.ETypedElement=new l({name:"ETypedElement","abstract":!0});L.eClass=t,L.get("eSuperTypes").add(o);var A=new p({name:"ordered",eType:i});A.eClass=a,e.ETypedElement_ordered=A;var O=new p({name:"unique",eType:i});O.eClass=a,e.ETypedElement_unique=O;var M=new p({name:"lowerBound",eType:r});M.eClass=a,e.ETypedElement_lowerBound=M;var _=new p({name:"upperBound",eType:r});_.eClass=a,e.ETypedElement_upperBound=_;var D=new p({name:"many",eType:i});D.eClass=a,e.ETypedElement_many=D;var P=new p({name:"required",eType:i});P.eClass=a,e.ETypedElement_required=P;var H=new h({name:"eType",eType:C});H.eClass=d,e.ETypedElement_eType=H,L.get("eStructuralFeatures").add(A),L.get("eStructuralFeatures").add(O),L.get("eStructuralFeatures").add(M),L.get("eStructuralFeatures").add(_),L.get("eStructuralFeatures").add(D),L.get("eStructuralFeatures").add(P),L.get("eStructuralFeatures").add(H);var B=e.EStructuralFeature=new l({name:"EStructuralFeature"});B.eClass=t,B.set("abstract",!0),B.set("interface",!1),B.get("eSuperTypes").add(L),a.get("eSuperTypes").add(B),d.get("eSuperTypes").add(B);var j=new p({name:"changeable",eType:i});j.eClass=a,e.EStructuralFeature_changeable=j;var F=new p({name:"volatile",eType:i});F.eClass=a,e.EStructuralFeature_volatile=F;var I=new p({name:"transient",eType:i});I.eClass=a,e.EStructuralFeature_transient=I;var q=new p({name:"defaultValueLiteral",eType:n});q.eClass=a,e.EStructuralFeature_defaultValueLiteral=q;var R=new p({name:"defaultValue",eType:n});R.eClass=a,e.EStructuralFeature_defaultValue=R;var U=new p({name:"unsettable",eType:i});U.eClass=a,e.EStructuralFeature_unsettable=U;var z=new p({name:"derived",eType:i});z.eClass=a,e.EStructuralFeature_derived=z,B.get("eStructuralFeatures").add(j),B.get("eStructuralFeatures").add(F),B.get("eStructuralFeatures").add(I),B.get("eStructuralFeatures").add(R),B.get("eStructuralFeatures").add(q),B.get("eStructuralFeatures").add(U),B.get("eStructuralFeatures").add(z);var W=e.EOperation=new l({name:"EOperation"});W.eClass=t,W.get("eSuperTypes").add(L);var X=e.EParameter=new l({name:"EParameter"});X.eClass=t,X.get("eSuperTypes").add(L),n.eClass=k,r.eClass=k,i.eClass=k,C.get("eSuperTypes").add(o),t.get("eSuperTypes").add(C),k.get("eSuperTypes").add(C);var V=new h({name:"eClassifiers",lowerBound:0,upperBound:-1,isContainment:!0,eType:C});V.eClass=d,e.EPackage_eClassifiers=V,y.get("eStructuralFeatures").add(V);var $=e.EFactory=new l({name:"EFactory"});$.eClass=t,$.get("eSuperTypes").add(s),e.EFactory=$;var J=new h({name:"eFactoryInstance",lowerBound:0,upperBound:1,eType:$});J.eClass=d,y.get("eStructuralFeatures").add(J),e.EPackage_eFactoryInstance=J;var K=new h({name:"ePackage",lowerBound:1,upperBound:1,eType:y,eOpposite:J});K.eClass=d,e.EFactory_ePackage=K,J.set("eOpposite",K),$.get("eStructuralFeatures").add(K),u(t),u(s),u(o),u(C),u(k),u(L),u(B),u(a),u(d),u(W),u(X),u(y),u($)}function b(){var e=new y("http://www.eclipse.org/emf/2002/Ecore");return e.add(n.EcorePackage),n.Registry.register(e),e}function E(e){var n=e.uri,r={},i=e.contents;if(i.length===1){var s=i[0];function o(e,n){var i=e.eClass,s=i.eAllStructuralFeatures();r[n]=e,t.each(s,function(t){var r=e.get(t.get("name"));if(r&&t.isTypeOf("EReference")&&t.get("isContainment"))if(t.get("upperBound")===1){var i=r.eURIFragmentSegment(t,n,-1);o(r,i)}else r.each(function(e){var i=r.indexOf(e),s=e.eURIFragmentSegment(t,n,i);o(e,s)})})}var u=s.eClass.get("eIDAttribute")||null;u?o(s,s.get(u.name)):o(s,"/")}return r}var e=this,t=e._||require("underscore"),n={create:function(e){if(!e.eClass)throw new Error("Cannot create EObject from undefined EClass");return new n.EObject({eClass:e})},createEPackage:function(e){return new f(e)},createEClass:function(e){return new l(e)},createEDataType:function(e){return new c(e)},createEAttribute:function(e){return new p(e)},createEReference:function(e){return new h(e)}};n.version="0.1.1",typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=n),exports.Ecore=n):e.Ecore=n;var r=n.EObject=function(e){return e||(e={}),this.eClass=e.eClass||null,this.values={},u(this),this},s={has:function(e){return this.values.hasOwnProperty(e)||this._isStructuralFeature(e)},isSet:function(e){if(!this.has(e))return!1;var t=this.eClass;if(!t)return!1;var n=this.get(e);return n instanceof o?n.size()>0:n!==null},set:function(e,t){return this.has(e)&&(this.values[e]=t),this},get:function(e){var t=null;return this.has(e)&&(t=this.values[e]),typeof t=="function"?t():t},isTypeOf:function(e){return this.eClass?this.eClass.get("name")===e:!1},isKindOf:function(e){return this.eClass?t.any(this.eClass.eAllSuperTypes(),function(t){return t.get("name")===e}):!1},eResource:function(){return this.eContainer?this.eContainer instanceof n.Resource?this.eContainer:this.eContainer.eResource():null},eURI:function(){var e=this.eResource(),t=E(e),n=this,r=function(){for(var e in t)if(t[e]===n)return e;return null}();return e.uri+"#"+r},eURIFragmentSegment:function(e,t,n){if(this.isKindOf("EModelElement"))return i(this);var r=this.eClass,s=r.get("eIDAttribute"),o;return s?o=val.get(s.get("name")):(o=t+"/@"+e.get("name"),n>-1&&(o+="."+n)),o},_getDefaultAttributeValue:function(e){var t=e.get("eType"),n=e.get("upperBound");if(!n)return null;if(n!==1)return[];if(!t)return null;switch(t.get("name")){case"EBoolean":return!1;case"EInteger":return 0;default:return null}},_getDefaultReferenceValue:function(e){var t=e.get("upperBound");return t?t===1?null:new o(this,e):null},_initFeature:function(e){var t=e.get("name");e.isTypeOf("EAttribute")?this.values[t]=this._getDefaultAttributeValue(e):this.values[t]=this._getDefaultReferenceValue(e)},_isStructuralFeature:function(e){var n=this.eClass;if(!n)return!1;var r=n.eAllStructuralFeatures();if(!r)return!1;var i=t.find(r,function(t){return t.values?t.values.name===e:!1});return i?(t.has(this.values,e)||this._initFeature(i),!0):!1},eAllStructuralFeatures:function(){if(!this.has("eSuperTypes"))return[];var e=this.eAllSuperTypes(),n=t.flatten(t.map(e,function(e){return e.eAllStructuralFeatures()})),r=t.union(n,this.get("eStructuralFeatures")._internal);return t.isArray(r)?r:[]},eAllSuperTypes:function(){if(!this.has("eSuperTypes"))return[];var e=this.get("eSuperTypes")._internal;if(!e)return[];var n=t.union(e,t.flatten(t.map(e,function(e){return e.eAllSuperTypes()})));return t.isArray(n)?n:[]},getEStructuralFeature:function(e){return this.has("eStructuralFeatures")?this.get("eStructuralFeatures").find(function(t){return t.get("name")===e}):null}};t.extend(r.prototype,s);var o=n.EList=function(e,t){return this._internal=[],this._owner=e,this._size=0,this._setFeature(t),this};o.prototype={_setFeature:function(e){e&&(this._feature=e,this._isContainment=this._feature.get("isContainment"))},add:function(e){return e?(this._isContainment&&(e.eContainingFeature=this._feature,e.eContainer=this._owner),this._size++,this._internal.push(e),this):this},addAll:function(e){return t.isArray(e)?(t.each(e,function(e){this.add(e)},this),this):this.add(e)},remove:function(e){var n=t.values(this._index);return this},size:function(){return this._size},at:function(e){return this._size<e?null:this._internal[e]},first:function(){return t.first(this._internal)},last:function(){return t.last(this._internal)},rest:function(e){return t.rest(this._internal,e)},each:function(e,n){return t.each(this._internal,e,n)},filter:function(e,n){return t.filter(this._internal,e,n)},find:function(e,n){return t.find(this._internal,e,n)},map:function(e,n){return t.map(this._internal,e,n)},reject:function(e,n){return t.reject(this._internal,e,n)},contains:function(e){return t.contains(this._internal,e)},indexOf:function(e){return t.indexOf(this._internal,e)}};var f=function(e){return e||(e={}),n.EcorePackage&&(this.eClass=n.EcorePackage.EPackage),this.values={},this.values.name=e.name,this.values.nsURI=e.nsURI,this.values.nsPrefix=e.nsPrefix,this.values.eClassifiers=new o(this),u(this),a(this,e),this};t.extend(f.prototype,s);var l=function(e){return e||(e={}),n.EcorePackage&&(this.eClass=n.EcorePackage.EClass),this.values={},this.values.name=e.name,this.values.abstract=e.abstract||!1,this.values.interface=e.interface||!1,this.values.eSuperTypes=new o(this),this.values.eStructuralFeatures=new o(this),u(this),a(this,e),this};t.extend(l.prototype,s);var c=function(e){return e||(e={}),n.EcorePackage&&(this.eClass=n.EcorePackage.EDataType),this.values={},this.values.name=e.name,u(this),a(this,e),this};t.extend(c.prototype,s);var h=function(e){return e||(e={}),n.EcorePackage&&(this.eClass=n.EcorePackage.EReference),this.values={},this.values.name=e.name,this.values.lowerBound=e.lowerBound||0,this.values.upperBound=e.upperBound||1,this.values.isContainment=e.isContainment||!1,this.values.eType=e.eType||null,this.values.eOpposite=e.eOpposite||null,u(this),a(this,e),this};t.extend(h.prototype,s);var p=function(e){return e||(e={}),n.EcorePackage&&(this.eClass=n.EcorePackage.EAttribute),this.values={},this.values.name=e.name,this.values.lowerBound=e.lowerBound||0,this.values.upperBound=e.upperBound||1,this.values.eType=e.eType||null,u(this),a(this,e),this};t.extend(p.prototype,s);var d=function(e){return e||(e={}),n.EcorePackage&&(this.eClass=n.EcorePackage.EFactory),this.values={},this.values.ePackage=e.ePackage,u(this),a(this,e),this};t.extend(d.prototype,s),n.EcorePackage=new f({name:"ecore"}),v(n.EcorePackage),n.EcorePackage.get("eClassifiers")._setFeature(n.EcorePackage.EPackage_eClassifiers),n.EcorePackage.eClass=n.EcorePackage.EPackage,n.EcorePackage.set("nsURI","http://www.eclipse.org/emf/2002/Ecore"),n.EcorePackage.set("nsPrefix","ecore"),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EModelElement),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.ENamedElement),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EPackage),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EClassifier),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EClass),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EDataType),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.ETypedElement),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EStructuralFeature),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EAttribute),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EReference),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EOperation),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EParameter),n.EcorePackage.get("eClassifiers").add(n.EcorePackage.EFactory),n.EcoreFactory=new d,n.EcoreFactory.eClass=n.EcorePackage.EFactory,n.EcorePackage.set("eFactoryInstance",n.EcoreFactory),n.EcoreFactory.create=function(e,t){switch(e){case"EPackage":return n.createEPackage(t);case"EClass":return n.createEClass(t);case"EDataType":return n.createEDataType(t);case"EAttribute":return n.createEAttribute(t);case"EReference":return n.createEReference(t);default:return null}};var m=n.EcoreFactory;n.$=e.jQuery||e.Zepto||e.ender||null;var g={get:function(e,t,r){if(!n.$)return;return n.$.ajax({url:e,dataType:"json",success:t,error:r})},post:function(e,t,r,i){if(!n.$)return;return n.$.ajax({type:"POST",url:e,dataType:"json",data:t,success:r,error:i})}};n.JSON={parse:function(e){function i(e,n){return!e||!n?function(e){}:function(r){var i=r.get("name"),o=e[i];r.isTypeOf("EAttribute")?n.set(i,o):r.get("upperBound")===1?n.set(i,s(o)):o&&t.each(o,function(e){n.get(i).add(s(e))})}}function s(e){if(e&&e.eClass){var r=n.Registry.getEObject(e.eClass),s=r.eAllStructuralFeatures(),o=n.create(r);return t.each(s,i(e,o)),o}return null}var r=[];return r.push(s(e)),r},toJSON:function(e){function i(e,t){var n=t.eResource(),i=e.eResource(),s=n!==i;if(!n||!i)return;r[n.uri]||(r[n.uri]=E(n));var o=r[n.uri];for(var u in o)if(o[u]===t)return s?n.uri+"#"+u:u;return null}function s(e,t){return!e||!t?function(){}:function(n){var r=n.get("name");if(!e.isSet(r))return;var s=e.get(r),u=n.get("upperBound")!==1;n.isTypeOf("EAttribute")?t[r]=s:n.get("isContainment")?u?(t[r]=[],s.each(function(e){t[r].push(o(e))})):t[r]=o(s):u?(t[r]=[],s.each(function(n){t[r].push({$ref:i(e,n),eClass:n.eClass.eURI()})})):t[r]={$ref:i(e,s),eClass:s.eClass.eURI()}}}function o(e){var n=e.eClass,r=n.eAllStructuralFeatures(),i={eClass:n.eURI()};return t.each(r,s(e,i)),i}var n=e.contents,r={};r[e.uri]=E(e);var u;if(n.length===1){var a=n[0];u=o(a)}return u}};var y=n.Resource=function(e){return this.uri=e,this.contents=[],this};y.prototype={clear:function(){return this.contents.length=0,this},add:function(e){return e&&(e.eContainer=this,this.contents.push(e)),this},addAll:function(e){return t.isArray(e)&&t.each(e,function(e){this.add(e)},this),this},getEObject:function(e){return e?E(this)[e]:null},each:function(e,n){return t.each(this.contents,e,n)},toJSON:function(){return n.JSON.toJSON(this)},save:function(e,t){var n=this.toJSON();n&&g.post(this.uri,n,e,t)},load:function(e,t,r){var i=this,s=function(t){var r=n.JSON.parse(t);return i.addAll(r),e(i)};return r?s(r):g.get(this.uri,s,t)}};var w=function(){var e;return w=function(){return e},w.prototype=this,e=new w,e.constructor=w,e.models={},e};w.prototype={register:function(e){return this.models[e.uri]=e,this},getEObject:function(e){var t=e.split("#"),n=t[0],r;t.length===2&&(r=t[1]);var i=this.models[n];if(i&&r){var s=E(i),o=s[r];return o}return null}},n.Registry=new w,b()})();