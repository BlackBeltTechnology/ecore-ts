(function(){function e(e){var n=e.eClass;if(n){var r=n.get("eAllStructuralFeatures");l.each(r,function(n){var r=n.get("name");if(r){var a=n.values.defaultValue,s=n.get("upperBound"),u=n.values.derived===!0,i=(n.values.containment===!0,e.values[r]);(null===i||void 0===i)&&(u?e.values[r]=n.values._:1!==s&&s?i instanceof c.EList?i._setFeature(n):e.values[r]=n.isTypeOf("EAttribute")?[]:new c.EList(e,n):t(e,r,a))}})}}function t(e,t,n){var r;r=null===n||void 0===n?null:0===n?0:n===!1?!1:n,e.values[t]=r}function n(e,t){return l.find(e.get("eAllStructuralFeatures"),function(e){return e.values.name===t})}function r(e,t){e.eClass&&l.each(t,function(e,t){var r=n(this.eClass,t),a=[];r&&(r.isTypeOf("EReference")&&(l.isArray(e)?l.each(e,function(e){a.push(e instanceof p?e:c.create(e))}):!e instanceof p&&(e=c.create(e))),1!==r.get("upperBound")&&r.get("upperBound")?this.get(t).addAll(a):this.set(t,e))},e)}function a(e){var t=e.get("eOperations").array(),n=e.get("eAllSuperTypes"),r=l.flatten(l.union(t||[],l.map(n||[],function(e){return a(e)})));return r}function s(e){if(e&&e.eClass){var t=a(e.eClass);t&&l.each(t,function(t){e[t.get("name")]=t._})}}function u(e){var t={},n=e.get("contents").array();if(1===n.length){var r=n[0],a=function(e,n){var r=e.eContents();t[n]=e,l.each(r,function(e){a(e,e.fragment())})},s=r.eClass.get("eIDAttribute")||null;s?a(r,r.get(s.name)):a(r,"/")}return t}function i(e){var t=/(>)(<)(\/*)/g,n=/ *(.*) +\n/g,r=/(<.+>)(.+\n)/g;e=e.replace(t,"$1\n$2$3").replace(n,"$1\n").replace(r,"$1\n$2");for(var a="",s=e.split("\n"),u=0,i="other",o={"single->single":0,"single->closing":-1,"single->opening":0,"single->other":0,"closing->single":0,"closing->closing":-1,"closing->opening":0,"closing->other":0,"opening->single":1,"opening->closing":0,"opening->opening":1,"opening->other":1,"other->single":0,"other->closing":-1,"other->opening":0,"other->other":0},l=0;s.length>l;l++){var c=s[l],d=Boolean(c.match(/<.+\/>/)),p=Boolean(c.match(/<\/.+>/)),f=Boolean(c.match(/<[^!].*>/)),g=d?"single":p?"closing":f?"opening":"other",h=i+"->"+g;i=g;var m="";u+=o[h];for(var v=0;u>v;v++)m+="    ";a+=m+c+"\n"}return a}var o=this,l=o._;l||"undefined"==typeof require||(l=require("underscore"));var c={create:function(e,t){var n,r;if(t?(n=t,n.eClass=e):e instanceof p?(n={},n.eClass=e):n=e,!n.eClass||n.eClass.get("abstract"))throw Error("Cannot create EObject from undefined or abstract EClass");return r=new p(n)}};c.version="0.3.1","undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=c),exports.Ecore=c):o.Ecore=c;var d={on:function(e,t,n){var r,a,s;if(!t)return this;for(e=e.split(/\s+/),r=this._callbacks||(this._callbacks={});a=e.shift();)s=r[a]||(r[a]=[]),s.push(t,n);return this},off:function(e,t,n){var r,a,s,u;if(!(a=this._callbacks))return this;if(!(e||t||n))return delete this._callbacks,this;for(e=e?e.split(/\s+/):l.keys(a);r=e.shift();)if((s=a[r])&&(t||n))for(u=s.length-2;u>=0;u-=2)t&&s[u]!==t||n&&s[u+1]!==n||s.splice(u,2);else delete a[r];return this},trigger:function(e){var t,n,r,a,s,u,i,o;if(!(n=this._callbacks))return this;for(o=[],e=e.split(/\s+/),a=1,s=arguments.length;s>a;a++)o[a-1]=arguments[a];for(;t=e.shift();){if((i=n.all)&&(i=i.slice()),(r=n[t])&&(r=r.slice()),r)for(a=0,s=r.length;s>a;a+=2)r[a].apply(r[a+1]||this,o);if(i)for(u=[t].concat(o),a=0,s=i.length;s>a;a+=2)i[a].apply(i[a+1]||this,u)}return this}},p=function(t){return t||(t={}),this.eClass=t.eClass,this.values={},t._&&(this._=t._),e(this),r(this,t),s(this),this};c.EObjectPrototype={setEClass:function(t){return this.eClass=t,e(this),r(this,this.values),s(this),this},create:function(e){return"EClass"===this.eClass.get("name")?c.create(this,e):void 0},has:function(e){return this.values.hasOwnProperty(e)||n(this.eClass,e)},isSet:function(e){if(!this.has(e))return!1;var t=this.eClass;if(!t)return!1;var n=this.get(e);return n instanceof f?n.size()>0:null!==n&&n!==void 0},set:function(e,t){var n,r,a,s;if(null===e)return this;l.isObject(e)||(r=e,(e={})[r]=t,t=arguments[2]);var u=this.eResource();for(n in e)a=e[n],a!==void 0&&this.has(n)&&(this.values[n]=a,s="change:"+n,this.trigger("change "+s,n),u&&u.trigger("change",this));return this},get:function(e){if(!e)return null;var t=e.eClass?e.get("name"):e,n=this.values[t];return"function"==typeof n?n.apply(this):n},isTypeOf:function(e){if(!e||!this.eClass)return!1;var t=e.eClass?e.get("name"):e;return this.eClass.get("name")===t},isKindOf:function(e){if(!e||!this.eClass)return!1;if(this.isTypeOf(e))return!0;var t=e.eClass?e.get("name"):e,n=this.eClass.get("eAllSuperTypes");return l.any(n,function(e){return e.get("name")===t})},eResource:function(){return this.isKindOf("Resource")?this:this.eContainer?this.eContainer.isKindOf("Resource")?this.eContainer:this.eContainer.eResource():null},eContents:function(){if(!this.eClass)return[];var e=this.eClass.get("eAllStructuralFeatures"),t=l.filter(e,function(e){return e.isTypeOf("EReference")&&e.get("containment")&&this.isSet(e.get("name"))},this);return l.flatten(l.map(t,function(e){var t=this.get(e.get("name"));return t instanceof c.EList?t.array():t},this))},eURI:function(){var e=this.eResource();return e.get("uri")+"#"+this.fragment()},fragment:function(){var e=this.eContainer,t=this.eClass,n=t.get("eIDAttribute");if(!e)return null;if(n)return this.get(n.get("name"));if(this.isKindOf("EModelElement"))return!e||e.isKindOf("Resource")?"/":e.fragment()+"/"+this.get("name");var r;if(this.eContainer.isKindOf("Resource"))r="/";else{var a=this.eContainingFeature;if(a&&(r=this.eContainer.fragment()+"/@"+a.get("name"),1!==a.get("upperBound"))){var s=this.eContainer.get(a.get("name")).indexOf(this);r+="."+s}}return r}},l.extend(p.prototype,c.EObjectPrototype,d);var f=c.EList=function(e,t){return this._internal=[],this._owner=e,this._size=0,this._setFeature(t),this};f.prototype={_setFeature:function(e){e&&(this._feature=e,this._isContainment=this._feature.get("containment"),l.each(this._internal,function(e){this._isContainment&&(e.eContainer=this._owner,e.eContainingFeature=this._feature)},this))},add:function(e){if(!e||!e instanceof p)return this;this._isContainment&&(e.eContainingFeature=this._feature,e.eContainer=this._owner),this._size++,this._internal.push(e);var t=this._owner.eResource(),n="add";return this._feature&&(n+=":"+this._feature.get("name")),this._owner.trigger(n,e),t&&t.trigger("add",this),this},addAll:function(){return l.each(l.flatten(arguments||[]),function(e){this.add(e)},this),this},remove:function(e){var t="remove",n=this._owner.eResource();return this._internal=l.without(this._internal,e),this._size=this._size-1,this._feature&&(t+=":"+this._feature.get("name")),this._owner.trigger(t,e),n&&n.trigger("remove",this),this},size:function(){return this._size},at:function(e){if(e>this._size)throw Error("Index Out Of Range");return this._internal[e]},array:function(){return this._internal},first:function(){return l.first(this._internal)},last:function(){return l.last(this._internal)},rest:function(e){return l.rest(this._internal,e)},each:function(e,t){return l.each(this._internal,e,t)},filter:function(e,t){return l.filter(this._internal,e,t)},find:function(e,t){return l.find(this._internal,e,t)},map:function(e,t){return l.map(this._internal,e,t)},reject:function(e,t){return l.reject(this._internal,e,t)},contains:function(e){return l.contains(this._internal,e)},indexOf:function(e){return l.indexOf(this._internal,e)}};var g=new p,h=new p,m=new p,v=new p,y=new p,E=new p,C=new p,T=new p,S=new p,_=new p,O=new p,w=new p;g.eClass=g,g.values={name:"EClass","abstract":!1,"interface":!1,eStructuralFeatures:new c.EList(g),eOperations:new c.EList(g),eSuperTypes:new c.EList(g),eAllSuperTypes:function(){return this._superTypes||(this._superTypes=this.get("eSuperTypes")._internal||[],this._superTypes=l.union(this._superTypes,l.flatten(l.map(this._superTypes,function(e){return e.get("eAllSuperTypes")})))),this.on("add:eSuperTypes",function(){delete this._superTypes,this._superTypes=this.get("eAllSuperTypes")},this),this._superTypes},eAllSubTypes:function(){var e,t;return e=c.EPackage.Registry.elements("EClass"),t=l.filter(e,function(e){return l.contains(e.get("eAllSuperTypes"),this)},this),l.isArray(t)?t:[]},eReferences:function(){var e,t;return e=this.get("eStructuralFeatures"),t=e.filter(function(e){return e.isTypeOf("EReference")})},eAttributes:function(){var e,t;return e=this.get("eStructuralFeatures"),t=e.filter(function(e){return e.isTypeOf("EAttribute")})},eIDAttribute:function(){var e,t;return e=this.get("eAllAttributes"),t=l.filter(e,function(e){return e.get("iD")===!0}),l.isArray(t)?null:t},eAllStructuralFeatures:function(){var e,t,n;return n=this.get("eAllSuperTypes"),this._features||(this._features=this.get("eStructuralFeatures").array()),this.on("add:eStructuralFeatures",function(){delete this._features,this._features=this.get("eStructuralFeatures").array()},this),e=l.flatten(l.map(this._superTypes||[],function(e){return e.get("eAllStructuralFeatures")})),t=l.union(e||[],this._features)},eAllAttributes:function(){var e,t,n;return e=this.get("eAllSuperTypes"),t=l.flatten(l.map(e||[],function(e){return e.get("eAllAttributes")})),n=l.union(t||[],l.filter(this.get("eStructuralFeatures")._internal,function(e){return e.isTypeOf("EAttribute")})),l.isArray(n)?n:[]},eAllContainments:function(){var e,t,n;return e=this.get("eAllSuperTypes"),t=l.flatten(l.map(e||[],function(e){return e.get("eAllContainments")})),n=l.union(t||[],l.filter(this.get("eStructuralFeatures")._internal,function(e){return e.isTypeOf("EReference")&&e.get("containment")})),l.isArray(n)?n:[]},eAllReferences:function(){var e,t,n;return e=this.get("eAllSuperTypes"),t=l.flatten(l.map(e||[],function(e){return e.get("eAllReferences")})),n=l.union(t||[],l.filter(this.get("eStructuralFeatures")._internal,function(e){return e.isTypeOf("EReference")&&!e.get("containment")})),l.isArray(n)?n:[]}},T.values={name:"abstract",lowerBound:0,upperBound:1,defaultValueLiteral:"false",defaultValue:!1,eType:v},S.values={name:"interface",lowerBound:0,upperBound:1,defaultValueLiteral:"false",defaultValue:!1,eType:v},_.values={name:"eStructuralFeatures",lowerBound:0,upperBound:-1,containment:!0},w.values={name:"eSuperTypes",lowerBound:0,upperBound:-1,containment:!1},O.values={name:"eOperations",lowerBound:0,upperBound:-1,containment:!0},g.get("eStructuralFeatures").add(T).add(S).add(w).add(_).add(O);var b=new p;b.values={name:"eAllStructuralFeatures",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:g.values.eAllStructuralFeatures};var B=new p;B.values={name:"eAllSuperTypes",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:g.values.eAllSuperTypes};var R=new p;R.values={name:"eAllSubTypes",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:g.values.eAllSubTypes};var A=new p;A.values={name:"eAllAttributes",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:g.values.eAllAttributes};var F=new p;F.values={name:"eAllContainments",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:g.values.eAllContainments};var x=new p;x.values={name:"eAllReferences",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:g.values.eAllReferences};var j=new p;j.values={name:"eReferences",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:g.values.eReferences};var P=new p;P.values={name:"eAttributes",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:g.values.eAttributes};var k=new p;k.values={name:"eIDAttribute",lowerBound:0,upperBound:1,derived:!0,containment:!1,_:g.values.eIDAttribute},g.get("eStructuralFeatures").add(b).add(B).add(R).add(A).add(x).add(F).add(P).add(j).add(k),g.getEStructuralFeature=function(e){var t;return t=e.eClass?e.get("name"):e,l.find(this.get("eAllStructuralFeatures"),function(e){return e.get("name")===t})};var I=new p;I.values={name:"getEStructuralFeature",lowerBound:0,upperBound:1,eParameters:new c.EList(this)},I._=g.getEStructuralFeature,g.get("eOperations").add(I),g.values.eStructuralFeatures._setFeature(_),g.values.eSuperTypes._setFeature(w),g.values.eOperations._setFeature(O);var L=g.create(),U=g.create(),V=g.create(),z=g.create(),D=g.create(),$=g.create(),J=g.create(),M=g.create(),N=g.create(),K=g.create(),q=g.create(),X=g.create(),Q=g.create(),Z=g.create(),G=g.create();T.eClass=q,S.eClass=q,_.eClass=X,_.values.eType=K,w.eClass=X,w.values.eType=g,O.eClass=X,O.values.eType=Q,b.eClass=X,b.values.eType=K,B.eClass=X,B.values.eType=g,R.eClass=X,R.values.eType=g,A.eClass=X,A.values.eType=q,x.eClass=X,x.values.eType=X,F.eClass=X,F.values.eType=X,P.eClass=X,P.values.eType=q,j.eClass=X,j.values.eType=X,k.eClass=X,k.values.eType=q,I.eClass=Q,I.values.eType=K,U.get("eSuperTypes").add(L),V.get("eSuperTypes").add(U),z.get("eSuperTypes").add(U),D.get("eSuperTypes").add(z),$.get("eSuperTypes").add(z),g.get("eSuperTypes").add($),J.get("eSuperTypes").add($),M.get("eSuperTypes").add(J),G.get("eSuperTypes").add(z),N.get("eSuperTypes").add(z),K.get("eSuperTypes").add(N),q.get("eSuperTypes").add(K),X.get("eSuperTypes").add(K),Q.get("eSuperTypes").add(N),Z.get("eSuperTypes").add(N);var H=new p,W=new p,Y=new p,et=new p,tt=new p,nt=new p,rt=new p;H.eClass=X,H.values={name:"eType",lowerBound:0,upperBound:1,containment:!1,eType:$},W.eClass=q,W.values={name:"ordered",lowerBound:0,upperBound:1,defaultValueLiteral:"true",defaultValue:!0,eType:v},Y.eClass=q,Y.values={name:"unique",lowerBound:0,upperBound:1,defaultValueLiteral:"true",defaultValue:!0,eType:v},et.eClass=q,et.values={name:"lowerBound",lowerBound:0,upperBound:1,defaultValueLiteral:"0",defaultValue:0,eType:m},tt.eClass=q,tt.values={name:"upperBound",lowerBound:0,upperBound:1,defaultValueLiteral:"1",defaultValue:1,eType:m},nt.eClass=q,nt.values={name:"many",lowerBound:0,upperBound:1,eType:v,derived:!0,_:function(){return 1!==this.get("upperBound")}},rt.eClass=q,rt.values={name:"required",lowerBound:0,upperBound:1,eType:v,derived:!0,_:function(){return 1===this.get("lowerBound")}},N.get("eStructuralFeatures").add(H).add(W).add(Y).add(et).add(tt).add(nt).add(rt);var at=new p;at.eClass=q,at.values={name:"name",lowerBound:0,upperBound:1,eType:h},z.get("eStructuralFeatures").add(at);var st=q.create({name:"changeable",eType:v}),ut=q.create({name:"volatile",eType:v}),it=q.create({name:"transient",eType:v}),ot=q.create({name:"defaultValueLiteral",eType:h}),lt=q.create({name:"defaultValue",eType:C,derived:!0}),ct=q.create({name:"unsettable",eType:v}),dt=q.create({name:"derived",eType:v});K.get("eStructuralFeatures").add(st).add(ut).add(it).add(ot).add(lt).add(ct).add(dt),lt.set({derived:!0});var pt=q.create({name:"containment",eType:v}),ft=q.create({name:"container",eType:v}),gt=q.create({name:"resolveProxies",eType:v}),ht=X.create({name:"eOpposite",eType:X});X.get("eStructuralFeatures").add(pt).add(ft).add(gt).add(ht);var mt=q.create({name:"iD",eType:v});q.get("eStructuralFeatures").add(mt),L.set({name:"EObject"}),U.set({name:"EModelElement","abstract":!0}),V.set({name:"EAnnotation"}),z.set({name:"ENamedElement","abstract":!0}),D.set({name:"EPackage"}),$.set({name:"EClassifier","abstract":!0}),J.set({name:"EDataType"}),M.set({name:"EEnum"}),N.set({name:"ETypedElement","abstract":!0}),K.set({name:"EStructuralFeature","abstract":!0}),q.set({name:"EAttribute"}),X.set({name:"EReference"}),Q.set({name:"EOperation"}),Z.set({name:"EParameter"}),G.set({name:"EEnumLiteral"});var vt=X.create({name:"eParameters",eType:Z,containment:!0,lowerBound:0,upperBound:-1});Q.get("eStructuralFeatures").add(vt);var yt=X.create({name:"eLiterals",eType:G,containment:!0,lowerBound:0,upperBound:-1});M.get("eStructuralFeatures").add(yt),EEnumLiteral_value=q.create({name:"value",eType:m}),EEnumLiteral_literal=q.create({name:"literal",eType:h}),G.get("eStructuralFeatures").add(EEnumLiteral_literal).add(EEnumLiteral_value),h.eClass=J,h.set({name:"EString"}),m.eClass=J,m.set({name:"EInt"}),v.eClass=J,v.set({name:"EBoolean"}),E.eClass=J,E.set({name:"EDate"}),y.eClass=J,y.set({name:"EDouble"}),C.eClass=J,C.set({name:"JSObject"}),c.ELong=J.create({name:"ELong"}),c.EFloat=J.create({name:"EFloat"}),c.EShort=J.create({name:"EShort"});var Et=X.create({name:"eClassifiers",lowerBound:0,upperBound:-1,containment:!0,eType:$}),Ct=X.create({name:"eSubPackages",lowerBound:0,upperBound:-1,containment:!0,eType:D});D.get("eStructuralFeatures").add(q.create({name:"nsURI",eType:h})).add(q.create({name:"nsPrefix",eType:h})).add(Et).add(Ct),c.EcorePackage=D.create({name:"ecore",nsPrefix:"ecore",nsURI:"http://www.eclipse.org/emf/2002/Ecore"}),c.EcorePackage.get("eClassifiers").add(L).add(U).add(V).add(z).add(D).add($).add(g).add(J).add(N).add(K).add(q).add(X).add(Q).add(Z).add(M).add(G).add(h).add(v).add(m).add(y).add(E).add(c.EShort).add(c.EFloat).add(c.ELong).add(C),c.EObject=L,c.EModelElement=U,c.EClass=g,c.EClassifier=$,c.EAnnotation=V,c.EPackage=D,c.ETypedElement=N,c.ENamedElement=z,c.EStructuralFeature=K,c.EAttribute=q,c.EReference=X,c.EEnum=M,c.EEnumLiteral=G,c.EDataType=J,c.EOperation=Q,c.EParameter=Z,c.EString=h,c.EBoolean=v,c.EInt=m,c.EDouble=y,c.EDate=E,c.JSObject=C,c.EPackage.Registry={_ePackages:{},getEPackage:function(e){return this._ePackages[e]},register:function(e){if(!e.isSet("nsURI"))throw Error("Cannot register EPackage without nsURI");this._ePackages[e.get("nsURI")]=e},ePackages:function(){return l.values(this._ePackages)},elements:function(e){var t=function(t){return e?e.eClass?t.eClass===e:t.eClass.get("name")===e:!0},n=this.ePackages(),r=function(e){return l.map(e.eContents(),function(e){return[e,r(e)]})},a=function(e){return r(e)},s=[n,l.map(n,a)];return s=l.flatten(s),s=l.filter(s,t)}},c.EPackage.Registry.register(c.EcorePackage),c.$=o.jQuery||o.Zepto||o.ender||null;var Tt={get:function(e,t,n,r){return c.$?c.$.ajax({url:e,dataType:t,success:n,error:r}):void 0},post:function(e,t,n,r,a){return c.$?c.$.ajax({type:"POST",url:e,dataType:n,data:t,success:r,error:a}):void 0}};c.JSON={dataType:"json",contentType:"application/json",parse:function(e,t){function n(e,t){return e&&t?function(n){if(!n.get("derived")){var r=n.get("name"),a=e[r];a!==void 0&&(n.isTypeOf("EAttribute")?t.set(r,a):n.get("containment")?1===n.get("upperBound")?t.set(r,s(a)):l.each(a||[],function(e){t.get(r).add(s(e))}):i.push({parent:t,feature:n,value:a}))}}:function(){}}function r(e){return"/"===e.substring(0,1)}function a(){function t(e,t,a,s){var u,i=a.$ref;u=r(i)?n[i]:o.getEObject(i),u&&(s?e.get(t.get("name")).add(u):e.set(t.get("name"),u))}var n=u(e);l.each(i,function(e){var n=e.parent,r=e.feature,a=e.value;1===r.get("upperBound")?t(n,r,a,!1):l.each(a,function(e){t(n,r,e,!0)})})}function s(e){var t;if(e&&e.eClass){var r=o.getEObject(e.eClass),a=r.get("eAllStructuralFeatures");t=c.create(r),l.each(a,n(e,t))}return t}var i=[],o=e.get("resourceSet")||c.ResourceSet.create(),d=s(t);d&&(e.add(d),a())},to:function(e){function t(e,t){var n=t.eResource(),r=e.eResource(),a=n!==r;if(n&&r){i[n.get("uri")]||(i[n.get("uri")]=u(n));var s=i[n.get("uri")];for(var o in s)if(s[o]===t)return a?n.get("uri")+"#"+o:o;return null}}function n(e,n,r){return r===!0?a(n):{$ref:t(e,n),eClass:n.eClass.eURI()}}function r(e,t){return e&&t?function(r,a){if("_"!==a[0]){var s=e.eClass.getEStructuralFeature(a),u=e.isSet(a);if(s&&u&&!s.get("derived")){var i=r,o=s.get("name"),l=1!==s.get("upperBound"),c=s.get("containment");s.isTypeOf("EAttribute")?t[o]=i:l?(t[o]=[],i.each(function(r){t[o].push(n(e,r,c))})):t[o]=n(e,i,c)}}}:function(){}}function a(e){var t=e.eClass,n=e.values,a={eClass:t.eURI()};return l.each(n,r(e,a)),a}var s=e.get("contents").array(),i={};i[e.get("uri")]=u(e);var o;if(1===s.length){var c=s[0];o=a(c)}return o}};var St=c.Resource=c.EClass.create({name:"Resource",eSuperTypes:[c.EObject],eStructuralFeatures:[{eClass:c.EAttribute,name:"uri",lowerBound:1,upperBound:1,eType:c.EString},{eClass:c.EReference,name:"contents",upperBound:-1,containment:!0,eType:c.EObject},{eClass:c.EReference,name:"resourceSet",upperBound:1,lowerBound:0,eType:c.ResourceSet}],eOperations:[{eClass:c.EOperation,name:"clear",_:function(){this.get("contents").clear()}},{eClass:c.EOperation,name:"add",_:function(e){return l.isObject(e)?(e.eContainer=this,this.get("contents").add(e),this):this}},{eClass:c.EOperation,name:"clear",_:function(){return this.get("contents").clear(),this}},{eClass:c.EOperation,name:"add",_:function(e){return e&&(e.eContainer=this,this.get("contents").add(e)),this}},{eClass:c.EOperation,name:"addAll",_:function(e){return l.isArray(e)&&l.each(e,function(e){this.add(e)},this),this}},{eClass:c.EOperation,name:"getEObject",eType:c.EObject,_:function(e){return e?u(this)[e]:null}},{eClass:c.EOperation,name:"each",_:function(e,t){return this.get("contents").each(e,t)}},{eClass:c.EOperation,name:"to",_:function(e,t){return e&&"function"==typeof e.to?e.to(this,t):c.JSON.to(this)}},{eClass:c.EOperation,name:"parse",_:function(e,t){return t&&"function"==typeof t.parse?t.parse(this,e):c.JSON.parse(this,e),this}},{eClass:c.EOperation,name:"save",_:function(e,t,n){n||(n={});var r=n.format?n.format:c.JSON,a=this.to(r),s=r.dataType,u=this.get("resourceSet"),i=u?u.uriConverter():null,o=this.get("uri");o=i?i.normalize(o):o,Tt.post(o,a,s,e,t)}},{eClass:c.EOperation,name:"load",_:function(e,t,n){n||(n={});var r=this,a=n.format||c.JSON,s=this.get("resourceSet"),u=s?s.uriConverter():null,i=this.get("uri"),o=function(t){return r.parse(t,a),r.trigger("change"),"function"==typeof e?e(r):void 0};return n.data?o(n.data):(s&&s.isSet("uri")&&(i=s.get("uri")+"/"+i),i=u?u.normalize(i):i,Tt.get(i,a.dataType,o,t))}},{eClass:c.EOperation,name:"_index",eType:C,_:function(){return u(this)}}]}),_t=function(){this.uriMap={}};_t.prototype={map:function(e,t){this.uriMap[e]=t},normalize:function(e){var t=e.split("#"),n=t[0],r=this.uriMap[n];if(r)return r;var a,s,u=n.lastIndexOf("/")+1;return a=n.slice(0,u),a===n?e:(s=n.slice(u,n.length),this.normalize(a)+s)}};var Ot=c.ResourceSet=c.EClass.create({name:"ResourceSet",eSuperTypes:[c.EObject],eStructuralFeatures:[{eClass:c.EAttribute,name:"uri",upperBound:1,lowerBound:0,eType:c.EString},{eClass:c.EReference,name:"resources",upperBound:-1,containment:!0,eType:St}],eOperations:[{eClass:c.EOperation,eType:c.Resource,upperBound:1,name:"create",_:function(e){var t,n,r=l.isObject(e)?e:{uri:e};if(!r.uri)throw Error("Cannot create Resource, missing URI parameter");return(n=this.get("resources").find(function(e){return e.get("uri")===r.uri}))?n:(t=c.EPackage.Registry.getEPackage(r.uri))?(t.eResource()?(n=t.eResource(),n.set("resourceSet",this),this.get("resources").add(n)):(n=c.Resource.create(r),n.add(t),n.set("resourceSet",this),this.get("resources").add(n)),n):(n=c.Resource.create(r),n.set("resourceSet",this),this.get("resources").add(n),n)}},{eClass:c.EOperation,eType:c.EObject,upperBound:1,name:"getEObject",_:function(e){var t,n=e.split("#"),r=n[0],a=n[1];if(!a)return null;if(t=this.get("resources").find(function(e){return e.get("uri")===r}))return t.getEObject(a);var s=c.EPackage.Registry.getEPackage(r);if(s){if(!s.eResource()){var u=this.create({uri:r});u.add(s)}return s.eResource().set("resourceSet",this),this.get("resources").add(s.eResource()),this.getEObject(e)}return null}},{eClass:c.EOperation,eType:c.EObject,upperBound:-1,name:"elements",_:function(e){var t=function(t){return e?e.eClass?t.eClass===e:t.eClass.get("name")===e:!0},n=this.get("resources").array(),r=l.flatten(l.map(n,function(e){return l.filter(l.values(e._index()),t)}));return r}},{eClass:c.EOperation,eType:c.JSObject,upperBound:1,name:"uriConverter",_:function(){return this._converter||(this._converter=new _t),this._converter}},{eClass:c.EOperation,eType:c.JSObject,upperBound:1,name:"toJSON",_:function(){var e={total:this.get("resources").size(),resources:[]};return this.get("resources").each(function(t){e.resources.push({uri:t.get("uri"),length:t.get("contents").size(),contents:t.get("contents").map(function(e){return{eURI:e.eURI(),eClass:e.eClass.eURI()}})})}),e}},{eClass:c.EOperation,name:"parse",_:function(e){e&&e.resources&&l.each(e.resources,function(e){e.uri&&resourceSet.create({uri:e.uri})},this)}},{eClass:c.EOperation,name:"fetch",_:function(e,t){var n=this.get("uri");if(console.log(n,this),n){var r=this,a=function(t){return r.parse(t),r.trigger("change"),"function"==typeof e?e(r):void 0};Tt.get(n,c.JSON.dataType,a,t)}}}]});St.getEStructuralFeature("resourceSet").set("eType",Ot);var wt=c.EPackage.create({name:"resources",nsPrefix:"resources",nsURI:"http://www.eclipselabs.org/ecore/2012/resources",eClassifiers:[Ot,St]}),bt=c.Resource.create({uri:c.EcorePackage.get("nsURI")});bt.add(c.EcorePackage);var Bt=c.Resource.create({uri:wt.get("nsURI")});Bt.add(wt),c.EPackage.Registry.register(wt),c.sax="function"==typeof require?require("sax"):o.sax,c.XMI={dataType:"xml",contentType:"application/xml",parse:function(e,t){function n(e){e&&l.each(e,function(e,t){if(-1!==t.indexOf(":")){var n=t.split(":");"xmlns"===n[0]&&m.push({prefix:n[1],uri:e})}})}function r(e){var t=l.find(m,function(t){return t.prefix===e});return t?t.uri:null}function a(e){return s(e.name)}function s(e){return-1!==e.indexOf(":")}function u(e){var t=e.split(":"),n=t[0],a=t[1],s=r(n)+"#//"+a;return s}function i(e){var t;if(e.parent&&e.parent.eObject){var n,r=p.parent.eObject,a=e.name,s=r.eClass.getEStructuralFeature(a);if(s&&s.get)if(n=s.get("eType"),n.get("abstract")){var i=e.attributes["xsi:type"];i&&(t=h.getEObject(u(i)))}else t=n}return t}function o(e){return a(e)?h.getEObject(u(e.name)):i(e)}function d(){function t(e){return"/"===e.substring(0,1)}function n(e,n,a){var s,u=a.split(/\s/),i=1!==n.get("upperBound");l.each(u,function(a){"#"===a[0]&&(a=a.substring(1,a.length)),s=t(a)?r[a]:h.getEObject(a),s&&(i?e.get(n.get("name")).add(s):e.set(n.get("name"),s))})}var r=e._index();l.each(v,function(e){var t=e.parent,r=e.feature,a=e.value;n(t,r,a)})}if(!c.sax)throw Error("Sax is missing.");var p,f,g=c.sax.parser(!0),h=e.get("resourceSet")||c.ResourceSet.create(),m=[],v=[];g.onopentag=function(e){var t,r,a,s;if(n(e.attributes),e.children=[],e.parent=p,e.parent&&e.parent.children.push(e),p=e,t=o(e),t&&(r=p.eObject=c.create(t),f||(f=r),l.each(e.attributes,function(e,t){r.has(t)&&(a=r.eClass.getEStructuralFeature(t),a.isTypeOf("EAttribute")?r.set(t,e):v.push({parent:r,feature:a,value:e}))}),e.parent&&(s=e.parent.eObject,s.has(e.name))))if(a=s.eClass.getEStructuralFeature(e.name),a.get("containment"))1===a.get("upperBound")?s.set(e.name,r):s.get(e.name).add(r);else{var u=e.attributes,i=u?u.href:null;i&&v.push({parent:s,feature:a,value:i})}},g.onclosetag=function(){var e;p&&p.parent&&(e=p.parent,delete p.parent,p=e)},g.write(t).close(),e.add(f),d()},to:function(e,t){function n(e){r+="<";var t;t=e.eContainingFeature&&e.eContainingFeature!==o?e.eContainingFeature.get("name"):s+":"+e.eClass.get("name"),r+=t,e.eContainer.isKindOf("Resource")&&(r+=' xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI"',r+=' xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"',r+=" xmlns:"+s+'="'+u+'"'),e.eContainingFeature.get("eType").get("abstract")&&(r+=' xsi:type="',r+=s+":"+e.eClass.get("name")+'"');var a=e.eClass.get("eAllStructuralFeatures"),i=l.filter(a,function(t){return!t.get("derived")&&t.isTypeOf("EAttribute")&&e.isSet(t.get("name"))}),d=l.filter(a,function(t){return!t.get("derived")&&t.isTypeOf("EReference")&&!t.get("containment")&&e.isSet(t.get("name"))});l.each(i,function(t){var n=t.get("name"),a=e.get(n);a!==!1&&"false"!==a&&(r+=" "+n+'="'+a+'"')});var p=[];if(l.each(d,function(t){var n=e.get(t.get("name")),a=n instanceof c.EList?n.array():n?[n]:[],s=l.filter(a,function(t){return t.eResource()!==e.eResource()});s.length&&p.push({feature:t,refs:s});var u=l.difference(a,s),i=l.map(u,function(e){return e.fragment()});i.length&&(r+=" "+t.get("name")+'="'+i.join(" ")+'"')}),0===e.eContents().length&&0===p.length)r+="/>";else{r+=">",l.each(p,function(e){var t=e.feature,n=e.refs,a=t.get("eType").get("abstract");l.each(n,function(e){r+="<"+t.get("name"),a&&(r+=' xsi:type="'+e.eClass.get("name")+'"'),r+=' href="'+e.eURI()+'"'+" />"})});var f=l.filter(a,function(t){return t.isTypeOf("EReference")&&t.get("containment")&&e.isSet(t.get("name"))});l.each(f,function(t){var r=e.get(t.get("name"));1!==t.get("upperBound")?r.each(function(e){n(e)}):n(r)}),r+="</"+t+">"}return r}var r="",a=e.get("contents").first(),s=a.eClass.eContainer.get("nsPrefix"),u=a.eClass.eContainer.get("nsURI"),o=c.Resource.getEStructuralFeature("contents");return n(a),r=t?i(r):r,r='<?xml version="1.0" encoding="UTF-8"?>\n'+r}}})();